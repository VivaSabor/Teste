<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viva Sabor - Receitas Personalizadas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        .text-gold { color: #cb8b32; }
        .text-insta { color: #fb5015; }
        .gradient-primary {
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
        }
        
        .gradient-secondary {
            background: linear-gradient(135deg, #7ba05b 0%, #d4a574 100%);
        }
        
        .gradient-accent {
            background: linear-gradient(135deg, #4a6b2a 0%, #b8941f 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .card-elegant {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid rgba(96, 128, 65, 0.1);
            box-shadow: 0 8px 32px rgba(96, 128, 65, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-elegant:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 60px rgba(96, 128, 65, 0.15);
            border-color: rgba(203, 139, 50, 0.3);
        }
        
        .recipe-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .recipe-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(203, 139, 50, 0.1), transparent);
            transition: left 0.6s ease;
        }
        
        .recipe-card:hover::before {
            left: 100%;
        }
        
        .recipe-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 25px 50px rgba(96, 128, 65, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
            border: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #4a6b2a 0%, #b8941f 100%);
            transition: left 0.3s ease;
            z-index: -1;
        }
        
        .btn-primary:hover::before {
            left: 0;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(96, 128, 65, 0.3);
        }
        
        .checkbox-custom {
            appearance: none;
            width: 22px;
            height: 22px;
            border: 2px solid #608041;
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .checkbox-custom:checked {
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
            border-color: #cb8b32;
            transform: scale(1.1);
        }
        
        .checkbox-custom:checked::after {
            content: '‚úì';
            position: absolute;
            top: -1px;
            left: 3px;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            stroke: #608041;
            stroke-linecap: round;
            transition: stroke-dasharray 0.6s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        .slide-up {
            animation: slideUp 0.8s ease-out;
        }
        
        .bounce-in {
            animation: bounceIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .text-gradient {
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .border-gradient {
            border: 2px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        linear-gradient(135deg, #608041, #cb8b32) border-box;
        }
        
        .recipe-step {
            position: relative;
            padding-left: 60px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .recipe-step::before {
            content: counter(step-counter);
            counter-increment: step-counter;
            position: absolute;
            left: 0;
            top: 0;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(96, 128, 65, 0.3);
        }
        
        .recipe-instructions {
            counter-reset: step-counter;
        }
        
        .ingredient-item {
            position: relative;
            padding-left: 35px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }
        
        .ingredient-item::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            top: 0;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .nav-item {
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);
            border-radius: 2px;
        }
        
        .logo-glow {
            transition: all 0.3s ease;
        }
        
        .logo-glow:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body style="background-color: #d5cbbf;">

    <!-- Login/Register Area -->
    <div id="auth-area" class="min-h-screen gradient-primary flex items-center justify-center p-6">
        <div class="glass-effect rounded-3xl shadow-2xl p-10 max-w-md w-full fade-in">
            <div class="text-center mb-10">
                <img src="https://i.ibb.co/CpyCzTP6/1755648281347.png" alt="Viva Sabor" class="w-32 h-32 object-contain mx-auto mb-6 logo-glow" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <span class="text-white font-bold text-2xl hidden gradient-accent w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-6">VS</span>
                <h1 class="text-4xl font-bold mb-3" style="color: #33160e;">Viva Sabor</h1>
                <p class="text-gray-700 font-medium">Nutri√ß√£o que acolhe, sabor que conforta</p>
            </div>
            
            <!-- Login Form -->
            <div id="login-form">
                <form onsubmit="handleLogin(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                            <input type="email" id="login-email" required 
                                   class="w-full p-4 border-gradient rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 transition-all duration-300 bg-white/80">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                            <input type="password" id="login-password" required 
                                   class="w-full p-4 border-gradient rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 transition-all duration-300 bg-white/80">
                        </div>
                        <button type="submit" class="w-full btn-primary py-4 rounded-xl font-bold text-lg shadow-lg">
                            Entrar
                        </button>
                    </div>
                </form>
                
                <div class="mt-6 text-center">
                    <p class="text-gray-600">N√£o tem conta? 
                        <button onclick="showCreateAccount()" class="font-semibold hover:underline" style="color: #608041;">
                            Criar conta
                        </button>
                    </p>
                </div>
            </div>
            
            <!-- Create Account Step 1 -->
            <div id="create-account-step1" class="hidden">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Criar Conta</h2>
                    <p class="text-gray-600">Dados b√°sicos da conta</p>
                </div>
                
                <form onsubmit="handleCreateAccountStep1(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                            <input type="text" id="register-name" required 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                            <input type="email" id="register-email" required 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                            <input type="tel" id="register-phone" required placeholder="(00) 00000-0000" oninput="formatPhone(this)"
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                            <input type="password" id="register-password" required minlength="6"
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <button type="submit" class="w-full text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #608041;">
                            Pr√≥ximo Passo
                        </button>
                    </div>
                </form>
                
                <div class="mt-6 text-center">
                    <button onclick="showLogin()" class="text-gray-600 hover:underline">
                        Voltar ao login
                    </button>
                </div>
            </div>
            
            <!-- Create Account Step 2 -->
            <div id="create-account-step2" class="hidden">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Criar Conta</h2>
                    <p class="text-gray-600">Informa√ß√µes pessoais</p>
                </div>
                
                <form onsubmit="handleCreateAccountStep2(event)">
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Idade</label>
                                <input type="number" id="register-age" required min="18" max="120"
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Sexo</label>
                                <select id="register-gender" required 
                                        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <option value="">Selecione</option>
                                    <option value="masculino">Masculino</option>
                                    <option value="feminino">Feminino</option>
                                    <option value="outro">Outro</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Peso (kg)</label>
                                <input type="number" id="register-weight" required min="30" max="300" step="0.1"
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Altura (cm)</label>
                                <input type="number" id="register-height" required min="100" max="250"
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Restri√ß√µes Alimentares</h3>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="gluten">
                                    <span class="text-sm text-gray-700">Sem Gl√∫ten</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="lactose">
                                    <span class="text-sm text-gray-700">Sem Lactose</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="diabetes">
                                    <span class="text-sm text-gray-700">Diab√©tico</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="vegetarian">
                                    <span class="text-sm text-gray-700">Vegetariano</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="vegan">
                                    <span class="text-sm text-gray-700">Vegano</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="low-carb">
                                    <span class="text-sm text-gray-700">Low Carb</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="keto">
                                    <span class="text-sm text-gray-700">Cetog√™nica</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="hypertension">
                                    <span class="text-sm text-gray-700">Hipertens√£o</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="nuts">
                                    <span class="text-sm text-gray-700">Sem Oleaginosas</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="checkbox-custom" name="register-restrictions" value="seafood">
                                    <span class="text-sm text-gray-700">Sem Frutos do Mar</span>
                                </label>
                            </div>
                        </div>
                        

                        
                        <div class="flex space-x-4">
                            <button type="button" onclick="backToStep1()" class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                                Voltar
                            </button>
                            <button type="submit" class="flex-1 text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #608041;">
                                Criar Conta
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="hidden min-h-screen" style="background-color: #d5cbbf;">
        <!-- Header -->
        <header class="glass-effect shadow-2xl border-b border-white/20">
            <div class="px-8 py-6">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <img src="https://i.ibb.co/CpyCzTP6/1755648281347.png" alt="Viva Sabor" class="w-14 h-14 object-contain logo-glow" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <span class="text-white font-bold text-lg hidden gradient-accent w-14 h-14 rounded-2xl flex items-center justify-center">VS</span>
                        <div>
                            <h1 class="text-2xl font-bold" style="color: #33160e;">Viva Sabor</h1>
                            <p id="user-greeting" class="text-sm text-gray-600 font-medium"></p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span id="user-plan" class="px-4 py-2 rounded-full text-sm font-bold text-white gradient-secondary shadow-lg floating"></span>
                        <div class="relative">
                            <button onclick="toggleUserMenu()" class="w-12 h-12 rounded-full flex items-center justify-center hover:bg-white/20 transition-all duration-300 glass-effect border border-white/30">
                                <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </button>
                            
                            <!-- User Menu Dropdown -->
                            <div id="user-menu" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl border z-50">
                                <div class="p-4 border-b">
                                    <p class="font-semibold text-gray-800" id="menu-user-name"></p>
                                    <p class="text-sm text-gray-600" id="menu-user-email"></p>
                                </div>
                                <div class="py-2">
                                    <button onclick="showProfileDetails()" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-gray-700">
                                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                        </svg>
                                        Detalhes do Perfil
                                    </button>
                                    <button onclick="showSupport()" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-gray-700">
                                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        Suporte
                                    </button>
                                    <button onclick="showSettings()" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-gray-700">
                                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                        Configura√ß√µes
                                    </button>
                                    <hr class="my-2">
                                    <button onclick="logout()" class="w-full text-left px-4 py-2 hover:bg-gray-50 text-red-600">
                                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                        </svg>
                                        Sair da Conta
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="pb-20">
            <!-- In√≠cio Section -->
            <div id="section-inicio" class="p-6">
                <div class="max-w-6xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Progresso do Dia</h2>
                    
                    <!-- Progress Cards -->
                    <div class="grid md:grid-cols-3 gap-8 mb-10">
                        <div class="card-elegant rounded-2xl p-8 slide-up">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-bold text-gradient">Refei√ß√µes</h3>
                                <span class="text-3xl">üçΩÔ∏è</span>
                            </div>
                            <div class="text-4xl font-bold text-gray-800 mb-3 meals-count">0/6</div>
                            <p class="text-gray-600 font-medium mb-4">Refei√ß√µes realizadas hoje</p>
                            <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div class="progress-meals h-3 rounded-full gradient-primary transition-all duration-1000 ease-out" style="width: 0%;"></div>
                            </div>
                            <div class="mt-4 flex space-x-2">                                
                                <button onclick="markMealConsumed()" class="text-xs bg-green-500 text-white px-3 py-1 rounded-full hover:bg-green-600 transition-colors">
                                    Refei√ß√£o ‚úÖ
                                </button>
                            </div>
                        </div>
                        
                        <div class="card-elegant rounded-2xl p-8 slide-up" style="animation-delay: 0.2s;">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-bold text-gradient">√Ågua</h3>
                                <span class="text-3xl" style="animation-delay: 1s;">üíß</span>
                            </div>
                            <div class="text-4xl font-bold text-gray-800 mb-3 water-count">0.0L</div>
                            <p class="text-gray-600 font-medium mb-4">Meta: 2L por dia</p>
                            <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div class="progress-water h-3 rounded-full gradient-primary transition-all duration-1000 ease-out" style="width: 0%;"></div>
                            </div>
                            <div class="mt-4 flex space-x-2">
                                <button onclick="addWaterIntake(200)" class="text-xs bg-blue-400 text-white px-2 py-1 rounded-full hover:bg-blue-500 transition-colors">
                                    +200ml
                                </button>
                                <button onclick="addWaterIntake(500)" class="text-xs bg-blue-600 text-white px-2 py-1 rounded-full hover:bg-blue-700 transition-colors">
                                    +500ml
                                </button>
                            </div>
                        </div>
                        
                        <div class="card-elegant rounded-2xl p-8 slide-up" style="animation-delay: 0.4s;">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-bold text-gradient">Calorias</h3>
                                <span class="text-3xl" style="animation-delay: 2s;">üî•</span>
                            </div>
                            <div class="text-4xl font-bold text-gray-800 mb-3 calories-count">0</div>
                            <p class="text-gray-600 font-medium mb-4">Meta: 1,800 kcal</p>
                            <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div class="progress-calories h-3 rounded-full gradient-primary transition-all duration-1000 ease-out" style="width: 0%;"></div>
                            </div>
                            <div class="mt-4">
                                <p class="text-xs text-gray-500">Atualizado automaticamente com as refei√ß√µes</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pr√©via das Refei√ß√µes -->
                    <div class="card-elegant rounded-2xl p-8 mb-10 bounce-in">
                        <h3 class="text-2xl font-bold text-gradient mb-6">Pr√©via das Refei√ß√µes do Dia</h3>
                        <div class="grid md:grid-cols-3 gap-6" id="meals-preview">
                            <!-- Meals preview will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- A√ß√µes R√°pidas -->
                    <div class="bg-white rounded-xl shadow-md p-6 mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">A√ß√µes R√°pidas</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="showSection('receitas')" class="flex flex-col items-center p-6 rounded-lg hover:bg-gray-50 transition-colors">
                                <div class="w-16 h-16 rounded-full flex items-center justify-center mb-3" style="background-color: #dcfce7;">
                                    <span class="text-3xl">üç≥</span>
                                </div>
                                <span class="text-base font-medium text-gray-700">Ver Receitas</span>
                            </button>
                            <button onclick="showSection('nutribox')" class="flex flex-col items-center p-6 rounded-lg hover:bg-gray-50 transition-colors">
                                <div class="w-16 h-16 rounded-full flex items-center justify-center mb-3" style="background-color: #fef3c7;">
                                    <span class="text-3xl">üì¶</span>
                                </div>
                                <span class="text-base font-medium text-gray-700">Pedir NutriBox</span>
                            </button>
                            <button onclick="showSection('consultas')" class="flex flex-col items-center p-6 rounded-lg hover:bg-gray-50 transition-colors">
                                <div class="w-16 h-16 rounded-full flex items-center justify-center mb-3" style="background-color: #dbeafe;">
                                    <span class="text-3xl">üë©‚Äç‚öïÔ∏è</span>
                                </div>
                                <span class="text-base font-medium text-gray-700">Consultas</span>
                            </button>
                            <button onclick="showSection('video-aulas')" class="flex flex-col items-center p-6 rounded-lg hover:bg-gray-50 transition-colors">
                                <div class="w-16 h-16 rounded-full flex items-center justify-center mb-3" style="background-color: #fce7f3;">
                                    <span class="text-3xl">üé•</span>
                                </div>
                                <span class="text-base font-medium text-gray-700">V√≠deo-aulas</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- FAQ Section -->
                    <div class="card-elegant rounded-2xl p-8 mb-8">
                        <h3 class="text-2xl font-bold text-gradient mb-6">‚ùì Perguntas Frequentes</h3>
                        <div class="space-y-4">
                            <div class="border border-gray-200 rounded-lg">
                                <button onclick="toggleFAQ('faq1')" class="w-full text-left p-4 hover:bg-gray-50 transition-colors flex justify-between items-center">
                                    <span class="font-semibold text-gray-800">Como funciona a personaliza√ß√£o das receitas?</span>
                                    <span id="faq1-icon" class="text-gray-500">+</span>
                                </button>
                                <div id="faq1" class="hidden p-4 pt-0 text-gray-600">
                                    Nossas receitas s√£o personalizadas com base nas suas restri√ß√µes alimentares, prefer√™ncias e objetivos nutricionais. Utilizamos intelig√™ncia artificial para criar um card√°pio √∫nico para voc√™.
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg">
                                <button onclick="toggleFAQ('faq2')" class="w-full text-left p-4 hover:bg-gray-50 transition-colors flex justify-between items-center">
                                    <span class="font-semibold text-gray-800">Posso cancelar minha assinatura a qualquer momento?</span>
                                    <span id="faq2-icon" class="text-gray-500">+</span>
                                </button>
                                <div id="faq2" class="hidden p-4 pt-0 text-gray-600">
                                    Sim! Voc√™ pode cancelar sua assinatura a qualquer momento sem taxas adicionais. O acesso aos recursos premium permanece ativo at√© o final do per√≠odo pago.
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg">
                                <button onclick="toggleFAQ('faq3')" class="w-full text-left p-4 hover:bg-gray-50 transition-colors flex justify-between items-center">
                                    <span class="font-semibold text-gray-800">Como funciona a NutriBox?</span>
                                    <span id="faq3-icon" class="text-gray-500">+</span>
                                </button>
                                <div id="faq3" class="hidden p-4 pt-0 text-gray-600">
                                    A NutriBox √© nosso servi√ßo de entrega de refei√ß√µes e sobremesas prontas, preparadas de acordo com suas restri√ß√µes alimentares. Voc√™ escolhe as categorias desejadas e recebe as refei√ß√µes em casa, prontas para consumo.
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg">
                                <button onclick="toggleFAQ('faq4')" class="w-full text-left p-4 hover:bg-gray-50 transition-colors flex justify-between items-center">
                                    <span class="font-semibold text-gray-800">As consultas s√£o presenciais ou online?</span>
                                    <span id="faq4-icon" class="text-gray-500">+</span>
                                </button>
                                <div id="faq4" class="hidden p-4 pt-0 text-gray-600">
                                    Oferecemos consultas tanto presenciais quanto online atrav√©s de videochamada, proporcionando comodidade e flexibilidade de hor√°rios. Voc√™ pode escolher a modalidade que preferir ao agendar.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dica do Dia -->
                    <div class="card-elegant rounded-2xl p-8 mb-8">
                        <h3 class="text-2xl font-bold text-gradient mb-6">üí° Dica do Dia</h3>
                        <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-6">
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center flex-shrink-0">
                                    <span class="text-2xl">üåü</span>
                                </div>
                                <div>
                                    <h4 class="font-bold text-yellow-800 mb-2">Dica Nutricional</h4>
                                    <p id="daily-tip" class="text-yellow-700 leading-relaxed">Beba √°gua regularmente ao longo do dia. A hidrata√ß√£o adequada √© fundamental para o bom funcionamento do organismo.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Envie sua Mensagem -->
                    <div class="card-elegant rounded-2xl p-8 mb-8">
                        <h3 class="text-2xl font-bold text-gradient mb-6">‚úâÔ∏è Envie sua Pergunta/Mensagem</h3>
                        <form onsubmit="handleContactForm(event)">
                            <div class="grid md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome</label>
                                    <input type="text" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                                    <input type="email" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Assunto</label>
                                <select required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <option value="">Selecione um assunto</option>
                                    <option value="duvida-planos">D√∫vidas sobre planos</option>
                                    <option value="suporte-tecnico">Suporte t√©cnico</option>
                                    <option value="nutribox">NutriBox</option>
                                    <option value="consultas">Consultas</option>
                                    <option value="receitas">Receitas</option>
                                    <option value="outros">Outros</option>
                                </select>
                            </div>
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Mensagem</label>
                                <textarea rows="4" required placeholder="Descreva sua d√∫vida ou mensagem..." class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 resize-none"></textarea>
                            </div>
                            <button type="submit" class="w-full btn-primary py-3 rounded-xl font-bold shadow-lg">
                                üì§ Enviar Mensagem
                            </button>
                        </form>
                    </div>
                    
                    <!-- Contato Section -->
                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <!-- Fale Conosco -->
                        <div class="card-elegant rounded-2xl p-6">
                            <h3 class="text-xl font-bold text-gradient mb-4">üìû Fale Conosco</h3>
                            <div class="space-y-3">
                                <div class="flex items-center space-x-3">
                                    <span class="text-green-600">üìß</span>
                                    <span class="text-gray-700">comercialvivasabor@gmail.com</span>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="text-green-600">üì±</span>
                                    <span class="text-gray-700">(71) 4002-8922</span>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <span class="text-insta">üÖæ</span>
                                    <span class="text-gray-700">Instagram: @Oficial.vivasabor</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hor√°rio de Funcionamento -->
                        <div class="card-elegant rounded-2xl p-6">
                            <h3 class="text-xl font-bold text-gradient mb-4">üïí Hor√°rio de Funcionamento</h3>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-gray-700">Segunda a Sexta:</span>
                                    <span class="text-gray-600">8h √†s 18h</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-700">S√°bado:</span>
                                    <span class="text-gray-600">9h √†s 14h</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-700">Domingo:</span>
                                    <span class="text-gray-600">Fechado</span>
                                </div>
                                <div class="mt-3 pt-3 border-t border-gray-200">
                                    <p class="text-sm text-gray-500">Suporte online 24h</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    

                </div>
            </div>
            
            <!-- Receitas Section -->
            <div id="section-receitas" class="hidden p-6">
                <div class="max-w-6xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Receitas Personalizadas</h2>
                        <button onclick="generateNewRecipes()" class="btn-primary px-8 py-3 rounded-xl font-bold shadow-lg">
                            ‚ú® Gerar Receitas
                        </button>
                    </div>
                    
                    <!-- Recipe Filters -->
                    <div class="bg-white rounded-xl shadow-md p-6 mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Filtrar por Tipo de Refei√ß√£o</h3>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="filterRecipes('all')" class="px-4 py-2 rounded-full text-sm font-medium bg-green-600 text-white">
                                Todas
                            </button>
                            <button onclick="filterRecipes('cafe-da-manha')" class="px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Caf√© da Manh√£
                            </button>
                            <button onclick="filterRecipes('lanche-manha')" class="px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Lanche da Manh√£
                            </button>
                            <button onclick="filterRecipes('almoco')" class="px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Almo√ßo
                            </button>
                            <button onclick="filterRecipes('lanche-tarde')" class="px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Lanche da Tarde
                            </button>
                            <button onclick="filterRecipes('janta')" class="px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Jantar
                            </button>
                            <button onclick="filterRecipes('ceia')" class="px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Ceia
                            </button>
                        </div>
                    </div>
                    
                    <!-- Recipes Grid -->
                    <div id="recipes-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Recipes will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- NutriBox Section -->
            <div id="section-nutribox" class="hidden p-6">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Pe√ßa sua NutriBox</h2>
                    <div class="bg-white rounded-xl shadow-md p-8">
                        <p class="text-gray-600 mb-6">Receba refei√ß√µes e sobremesas prontas, preparadas de acordo com suas restri√ß√µes alimentares!</p>
                        
                        <!-- Order Confirmation Section -->
                        <div id="order-confirmation" class="hidden">
                            <div class="text-center mb-8">
                                <div class="w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 gradient-primary">
                                    <span class="text-3xl">‚úÖ</span>
                                </div>
                                <h3 class="text-2xl font-bold text-gradient mb-2">Pedido Realizado com Sucesso!</h3>
                                <p class="text-gray-600">Seu pedido foi confirmado e est√° sendo processado</p>
                            </div>
                            
                            <div class="card-elegant rounded-2xl p-6 mb-6">
                                <h4 class="text-lg font-bold text-gray-800 mb-4">üì¶ Informa√ß√µes de Entrega</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Tempo estimado:</span>
                                        <span id="delivery-time" class="font-bold text-green-600"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Status:</span>
                                        <span class="font-bold text-blue-600">Preparando pedido</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">N√∫mero do pedido:</span>
                                        <span id="order-number" class="font-bold text-gray-800"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-center">
                                <button onclick="resetNutriBoxForm()" class="btn-primary px-8 py-3 rounded-xl font-bold shadow-lg">
                                    Fazer Novo Pedido
                                </button>
                            </div>
                        </div>
                        
                        <form id="nutribox-form" onsubmit="handleNutriBoxOrder(event)">
                            <div class="mb-8">
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Selecione as Op√ß√µes Desejadas</h3>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-300 transition-colors">
                                        <input type="checkbox" name="nutribox-meals" value="principais" data-price="34.90" class="checkbox-custom" onchange="updateNutriBoxTotal()">
                                        <div>
                                            <span class="font-medium text-gray-800">Refei√ß√µes Principais</span>
                                            <p class="text-sm text-gray-600">Caf√© da Manh√£, Almo√ßo e Jantar</p>
                                            <p class="text-sm font-bold text-green-600">R$ 34,90</p>
                                        </div>
                                    </label>
                                    <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-300 transition-colors">
                                        <input type="checkbox" name="nutribox-meals" value="lanches" data-price="24.90" class="checkbox-custom" onchange="updateNutriBoxTotal()">
                                        <div>
                                            <span class="font-medium text-gray-800">Lanches e Ceia</span>
                                            <p class="text-sm text-gray-600">Lanche da Manh√£, Tarde e Ceia</p>
                                            <p class="text-sm font-bold text-green-600">R$ 24,90</p>
                                        </div>
                                    </label>
                                    <label class="flex items-center space-x-3 p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-300 transition-colors md:col-span-2">
                                        <input type="checkbox" name="nutribox-meals" value="sobremesas" data-price="14.99" class="checkbox-custom" onchange="toggleFruitSelection(); updateNutriBoxTotal()">
                                        <div>
                                            <span class="font-medium text-gray-800">Sobremesas</span>
                                            <p class="text-sm text-gray-600">Sobremesas saud√°veis e nutritivas</p>
                                            <p class="text-sm font-bold text-green-600">R$ 14,99</p>
                                        </div>
                                    </label>
                                </div>
                                
                                <!-- Fruit Selection (Hidden by default) -->
                                <div id="fruit-selection" class="hidden mb-8">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Prefer√™ncias de Frutas para Sobremesas</h3>
                                    <p class="text-sm text-gray-600 mb-4">Selecione as frutas que gostaria de evitar no seu card√°pio:</p>
                                    
                                    <div class="grid md:grid-cols-3 gap-6">
                                        <!-- Frutas C√≠tricas -->
                                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                            <h4 class="font-semibold text-orange-800 mb-3">üçä Frutas C√≠tricas</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="laranja" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Laranja</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="limao" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Lim√£o</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="tangerina" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Tangerina</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="grapefruit" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Grapefruit</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <!-- Frutas Vermelhas -->
                                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                            <h4 class="font-semibold text-red-800 mb-3">üçì Frutas Vermelhas</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="morango" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Morango</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="framboesa" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Framboesa</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="mirtilo" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Mirtilo</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="amora" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Amora</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <!-- Frutas Tropicais -->
                                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                            <h4 class="font-semibold text-yellow-800 mb-3">ü•≠ Frutas Tropicais</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="manga" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Manga</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="abacaxi" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Abacaxi</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="maracuja" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Maracuj√°</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="kiwi" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Kiwi</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <!-- Frutas Comuns -->
                                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                            <h4 class="font-semibold text-green-800 mb-3">üçé Frutas Comuns</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="maca" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Ma√ß√£</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="banana" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Banana</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="pera" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">P√™ra</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="uva" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Uva</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <!-- Frutas Especiais -->
                                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                            <h4 class="font-semibold text-purple-800 mb-3">ü•• Frutas Especiais</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="coco" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Coco</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="abacate" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Abacate</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="figo" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Figo</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="roma" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Rom√£</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <!-- Frutas Secas -->
                                        <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                                            <h4 class="font-semibold text-amber-800 mb-3">ü•ú Frutas Secas</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="tamara" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">T√¢mara</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="uva-passa" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Uva Passa</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="damasco-seco" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Damasco Seco</span>
                                                </label>
                                                <label class="flex items-center space-x-2">
                                                    <input type="checkbox" name="avoid-fruits" value="figo-seco" class="checkbox-custom">
                                                    <span class="text-sm text-gray-700">Figo Seco</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-8">
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Informa√ß√µes de Entrega</h3>
                                <div class="grid md:grid-cols-2 gap-6">
                                </div>
                            </div>
                            
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                                    <input type="text" id="nutribox-name" required 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CPF</label>
                                    <input type="text" id="nutribox-cpf" required placeholder="000.000.000-00" maxlength="14" oninput="formatCPF(this)"
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                                    <input type="tel" id="nutribox-phone" required placeholder="(00) 00000-0000" oninput="formatPhone(this)"
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">CEP</label>
                                    <input type="text" id="nutribox-cep" required placeholder="00.000-000" maxlength="10" onblur="calculateShipping()" oninput="formatCEP(this)"
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Endere√ßo + Complemento</label>
                                    <input type="text" id="nutribox-address" required 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">M√©todo de Pagamento</label>
                                    <select id="nutribox-payment" required 
                                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <option value="">Selecione</option>
                                        <option value="pix">PIX</option>
                                        <option value="debit">Cart√£o de D√©bito</option>
                                        <option value="credit">Cart√£o de Cr√©dito</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mt-8 bg-gray-50 rounded-lg p-6">
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Resumo do Pedido</h3>
                                <div id="selected-items-summary" class="mb-4">
                                    <p class="text-gray-600 text-sm">Selecione os itens acima para ver o resumo</p>
                                </div>
                                <div class="flex justify-between items-center mb-2">
                                    <span>Subtotal</span>
                                    <span id="subtotal-cost">R$ 0,00</span>
                                </div>
                                <div class="flex justify-between items-center mb-2">
                                    <span>Frete</span>
                                    <span id="shipping-cost">R$ 0,00</span>
                                </div>
                                <div id="premium-discount-nutribox" class="hidden flex justify-between items-center mb-2 text-green-600">
                                    <span>Desconto Premium (10%)</span>
                                    <span id="discount-amount">-R$ 0,00</span>
                                </div>
                                <hr class="my-3">
                                <div class="flex justify-between items-center font-bold text-lg">
                                    <span>Total</span>
                                    <span id="total-cost">R$ 0,00</span>
                                </div>
                            </div>
                            
                            <button type="submit" class="w-full mt-6 text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);">
                                Finalizar Pedido
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Consultas Section -->
            <div id="section-consultas" class="hidden p-6">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Consultas</h2>
                    
                    <div id="premium-only-message" class="hidden bg-yellow-50 border border-yellow-200 rounded-xl p-8 text-center mb-8">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: #fef3c7;">
                            <span class="text-2xl">‚≠ê</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Recurso Premium</h3>
                        <p class="text-gray-600">O agendamento de consultas est√° dispon√≠vel apenas para usu√°rios Premium.</p>
                    </div>
                    
                    <div id="appointments-section">
                        <div class="grid md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white rounded-xl shadow-md p-6 text-center">
                                <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: #dbeafe;">
                                    <span class="text-2xl">üë©‚Äç‚öïÔ∏è</span>
                                </div>
                                <h3 class="text-lg font-bold text-gray-800 mb-2">Nutricionista</h3>
                                <p class="text-gray-600 text-sm mb-4">Orienta√ß√£o nutricional personalizada</p>
                                <button onclick="scheduleAppointment('Nutricionista')" class="w-full text-white py-2 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background: linear-gradient(135deg, #608041 0%, #cb8b32 100%);">
                                    Agendar
                                </button>
                            </div>
                          
                        <div class="bg-white rounded-xl shadow-md p-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Consultas Agendadas</h3>
                            <div id="scheduled-appointments">
                                <!-- Appointments will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- V√≠deo-aulas Section -->
            <div id="section-video-aulas" class="hidden p-6">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">V√≠deo-aulas</h2>
                    
                    <div id="videos-premium-message" class="hidden bg-yellow-50 border border-yellow-200 rounded-xl p-8 text-center mb-8">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: #fef3c7;">
                            <span class="text-2xl">üé•</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Conte√∫do Premium</h3>
                        <p class="text-gray-600">As v√≠deo-aulas est√£o dispon√≠veis apenas para usu√°rios Premium.</p>
                    </div>
                    
                    <div id="videos-section" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Videos will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 glass-effect border-t border-white/20 z-40 backdrop-blur-lg">
            <div class="flex justify-around items-center py-3">
                <button onclick="showSection('inicio')" id="nav-inicio" class="nav-item active flex flex-col items-center py-3 px-4 text-green-600 transition-all duration-300">
                    <svg class="w-7 h-7 mb-1" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                    </svg>
                    <span class="text-xs font-bold">In√≠cio</span>
                </button>
                <button onclick="showSection('receitas')" id="nav-receitas" class="nav-item flex flex-col items-center py-3 px-4 text-gray-400 hover:text-green-600 transition-all duration-300">
                    <svg class="w-7 h-7 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                    </svg>
                    <span class="text-xs font-bold">Receitas</span>
                </button>
                <button onclick="showSection('nutribox')" id="nav-nutribox" class="nav-item flex flex-col items-center py-3 px-4 text-gray-400 hover:text-green-600 transition-all duration-300">
                    <svg class="w-7 h-7 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                    <span class="text-xs font-bold">NutriBox</span>
                </button>
                <button onclick="showSection('consultas')" id="nav-consultas" class="nav-item flex flex-col items-center py-3 px-4 text-gray-400 hover:text-green-600 transition-all duration-300">
                    <svg class="w-7 h-7 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <span class="text-xs font-bold">Consultas</span>
                </button>
                <button onclick="showSection('video-aulas')" id="nav-video-aulas" class="nav-item flex flex-col items-center py-3 px-4 text-gray-400 hover:text-green-600 transition-all duration-300">
                    <svg class="w-7 h-7 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1.01M15 10h1.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="text-xs font-bold">V√≠deo-aulas</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- Modals -->
    
    <!-- Plan Selection Modal -->
    <div id="plan-selection-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-2xl w-full mx-4">
            <div class="text-center mb-10">
                <div class="w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 gradient-primary">
                    <span class="text-white text-3xl">‚≠ê</span>
                </div>
                <h2 class="text-4xl font-bold text-gradient mb-4">Venha fazer parte da Viva Sabor!</h2>
                <p class="text-gray-600 text-lg">Escolha o seu plano e desbloqueie todos os recursos</p>
            </div>
            
            <!-- Plans Carousel -->
            <div class="relative mb-10">
                <div class="overflow-hidden rounded-3xl">
                    <div id="plans-carousel" class="flex transition-transform duration-500 ease-in-out">
                        <!-- Plano B√°sico -->
                        <div class="w-full flex-shrink-0 px-4">
                            <div class="border-2 border-gray-200 rounded-2xl p-8 hover:border-green-300 transition-colors bg-white">
                                <div class="text-center mb-6">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Plano B√°sico</h3>
                                    <div class="text-4xl font-bold text-green-600 mb-2">R$ 69,90</div>
                                    <p class="text-gray-600">por m√™s</p>
                                    <div class="mt-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-bold">
                                        7 DIAS GR√ÅTIS
                                    </div>
                                </div>
                                <ul class="space-y-3 mb-8 min-h-[320px]">
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>Receitas personalizadas ilimitadas</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>Planos alimentares semanais com card√°pio completo</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>V√≠deo-aulas de preparo passo a passo</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span></span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>Suporte personalizado</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>1 consulta gratuita com nutricionista</span>
                                    </li>
                                </ul>
                                <button onclick="selectPlan('B√°sico', 69.90)" class="w-full btn-primary py-3 rounded-xl font-bold shadow-lg">
                                    Escolher B√°sico
                                </button>
                            </div>
                        </div>
                        
                        <!-- Plano Premium -->
                        <div class="w-full flex-shrink-0 px-4">
                            <div class="border-2 border-green-500 rounded-2xl p-8 relative bg-gradient-to-br from-green-50 to-blue-50">
                                <div class="absolute -top-1 left-1/2 transform -translate-x-1/2">
                                    <span class="bg-green-500 text-gold px-1 py-1 rounded-full text-sm font-bold">MAIS POPULAR</span>
                                </div>
                                <div class="text-center mb-6">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Plano Premium</h3>
                                    <div class="text-4xl font-bold text-green-600 mb-2">R$ 149,90</div>
                                    <p class="text-gray-600">por m√™s</p>
                                </div>
                                <ul class="space-y-3 mb-8 min-h-[320px]">
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span><strong>Tudo do Plano B√°sico inclu√≠do</strong></span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>Desconto de 10% em todas as compras da NutriBox</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>4 consultas mensais com nutricionistas especializados</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>Agendamento flex√≠vel de consultas presenciais ou online</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>Suporte priorit√°rio 24h</span>
                                    </li>
                                    <li class="flex items-start text-gray-700">
                                        <span class="text-green-500 mr-3 mt-1">‚úì</span>
                                        <span>    a</span>
                                    </li>
                                </ul>
                                <button onclick="selectPlan('Premium', 149.90)" class="w-full btn-primary py-3 rounded-xl font-bold shadow-lg">
                                    Escolher Premium
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Carousel Navigation -->
                <div class="flex justify-center mt-6 space-x-2">
                    <button onclick="showPlan(0)" id="plan-dot-0" class="w-3 h-3 rounded-full bg-green-500 transition-all duration-300"></button>
                    <button onclick="showPlan(1)" id="plan-dot-1" class="w-3 h-3 rounded-full bg-gray-300 transition-all duration-300"></button>
                </div>
                
                <!-- Swipe indicators -->
                <div class="text-center mt-4">
                    <p class="text-gray-500 text-sm">‚Üê Deslize para ver os planos ‚Üí</p>
                </div>
            </div>
            
            <div class="text-center">
                <button onclick="closePlanSelectionModal()" class="text-gray-600 hover:text-gray-800 font-medium">
                    Continuar com plano gratuito
                </button>
            </div>
        </div>
    </div>
    
    <!-- Payment Modal -->
    <div id="payment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-md w-full mx-4">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Finalizar Pagamento</h2>
                <p class="text-gray-600">Complete sua assinatura</p>
            </div>
            
            <div class="bg-gray-50 rounded-xl p-6 mb-8">
                <div class="flex justify-between items-center mb-2">
                    <span class="font-medium text-gray-700">Plano:</span>
                    <span id="selected-plan-name" class="text-gray-800 font-bold"></span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="font-medium text-gray-700">Valor mensal:</span>
                    <span id="selected-plan-price" class="text-green-600 font-bold text-xl"></span>
                </div>
            </div>
            
            <form id="payment-form" onsubmit="handlePayment(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">M√©todo de Pagamento</label>
                        <select id="payment-method" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            <option value="">Selecione</option>
                            <option value="pix">PIX</option>
                            <option value="credit">Cart√£o de Cr√©dito</option>
                            <option value="debit">Cart√£o de D√©bito</option>
                        </select>
                    </div>
                    
                    <div id="card-fields" class="hidden space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">N√∫mero do Cart√£o</label>
                            <input type="text" id="card-number" placeholder="0000 0000 0000 0000" maxlength="19" oninput="formatCardNumber(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Validade</label>
                                <input type="text" id="card-expiry" placeholder="MM/AA" maxlength="5" oninput="formatCardExpiry(this)" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">CVV</label>
                                <input type="text" id="card-cvv" placeholder="123" maxlength="3" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome no Cart√£o</label>
                            <input type="text" id="card-name" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                    </div>
                    
                    <div class="flex space-x-4">
                        <button type="button" onclick="closePaymentModal()" class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                            Cancelar
                        </button>
                        <button type="submit" class="flex-1 btn-primary py-3 rounded-lg font-semibold">
                            Confirmar Pagamento
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Appointment Modal -->
    <div id="appointment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-8">
                <h2 id="appointment-modal-title" class="text-3xl font-bold text-gray-800 mb-2">Agendar Consulta</h2>
                <p class="text-gray-600">Escolha a data e hor√°rio</p>
            </div>
            
            <form id="appointment-form" onsubmit="handleAppointmentSubmit(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data da Consulta</label>
                        <input type="date" id="appointment-date" required 
                               class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Hor√°rio</label>
                        <select id="appointment-time" required 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                            <option value="">Selecione um hor√°rio</option>
                            <option value="08:00">08:00</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                        </select>
                    </div>
                    <div class="flex space-x-4">
                        <button type="button" onclick="closeAppointmentModal()" class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                            Cancelar
                        </button>
                        <button type="submit" class="flex-1 text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #5f723f;">
                            Agendar
                        </button>
                    </div>
                </div>
            </form>
            
            <button onclick="closeAppointmentModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-xl p-8 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Configura√ß√µes</h2>
            </div>
            
            <!-- Settings Tabs -->
            <div class="flex space-x-4 mb-8 border-b">
                <button onclick="showSettingsTab('profile')" id="settings-tab-profile" class="py-2 px-4 border-b-2 border-green-500 font-semibold" style="color: #5f723f;">
                    Editar Perfil
                </button>
                <button onclick="showSettingsTab('restrictions')" id="settings-tab-restrictions" class="py-2 px-4 border-b-2 border-transparent text-gray-600 hover:text-green-700 font-semibold">
                    Restri√ß√µes Alimentares
                </button>
            </div>
            
            <!-- Edit Profile Tab -->
            <div id="settings-profile-tab">
                <form id="edit-profile-form" onsubmit="handleEditProfile(event)">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                            <input type="text" id="edit-name" required 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Idade</label>
                            <input type="number" id="edit-age" required min="18" max="120"
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sexo</label>
                            <select id="edit-gender" required 
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="masculino">Masculino</option>
                                <option value="feminino">Feminino</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Peso (kg)</label>
                            <input type="number" id="edit-weight" required min="30" max="300" step="0.1"
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Altura (cm)</label>
                            <input type="number" id="edit-height" required min="100" max="250"
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <button type="submit" class="w-full text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #5f723f;">
                            Salvar Altera√ß√µes
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Restrictions Tab -->
            <div id="settings-restrictions-tab" class="hidden">
                <form id="edit-restrictions-form" onsubmit="handleEditRestrictions(event)">
                    <div class="grid md:grid-cols-2 gap-4">
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="gluten">
                            <span class="text-gray-700">Sem Gl√∫ten</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="lactose">
                            <span class="text-gray-700">Sem Lactose</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="diabetes">
                            <span class="text-gray-700">Diab√©tico</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="vegetarian">
                            <span class="text-gray-700">Vegetariano</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="vegan">
                            <span class="text-gray-700">Vegano</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="low-carb">
                            <span class="text-gray-700">Low Carb</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="keto">
                            <span class="text-gray-700">Cetog√™nica</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="hypertension">
                            <span class="text-gray-700">Hipertens√£o</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="nuts">
                            <span class="text-gray-700">Sem Oleaginosas</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" class="checkbox-custom" name="edit-restrictions" value="seafood">
                            <span class="text-gray-700">Sem Frutos do Mar</span>
                        </label>
                    </div>
                    
                    <div class="mt-6">
                        <button type="submit" class="w-full text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #5f723f;">
                            Salvar Restri√ß√µes
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="mt-8 text-center">
                <button onclick="closeSettingsModal()" class="border-2 border-gray-300 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                    Fechar
                </button>
            </div>
            
            <button onclick="closeSettingsModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = JSON.parse(localStorage.getItem('vivasabor_current_user') || 'null');
        let users = JSON.parse(localStorage.getItem('vivasabor_users') || '{}');
        let appointments = JSON.parse(localStorage.getItem('vivasabor_appointments') || '{}');
        let tempUserData = {};
        let currentAppointmentType = '';
        let selectedPlan = { name: '', price: 0 };

        // Recipe database with weekly rotation
        const recipeWeeks = {
            week1: {
                'cafe-da-manha': [
                    { 
                        name: "Omelete Proteica com Espinafre e Queijo", 
                        calories: 385, 
                        ingredients: ["3 ovos org√¢nicos inteiros", "2 claras de ovo", "1 x√≠cara de espinafre fresco", "50g de queijo cottage", "30g de queijo mussarela light", "1 colher de sopa de azeite extra virgem", "1 tomate cereja cortado", "Sal rosa e pimenta do reino", "Or√©gano fresco"], 
                        instructions: "1. Lave bem o espinafre e seque com papel toalha. 2. Separe os ovos, colocando as claras em uma tigela e os ovos inteiros em outra. 3. Bata vigorosamente os ovos inteiros com as claras por 2 minutos at√© formar espuma leve. 4. Tempere com uma pitada de sal rosa e pimenta do reino mo√≠da na hora. 5. Aque√ßa uma frigideira antiaderente de 24cm em fogo m√©dio e adicione o azeite extra virgem. 6. Quando o azeite estiver morno, adicione o espinafre e refogue por 1 minuto at√© murchar completamente. 7. Despeje os ovos batidos uniformemente sobre o espinafre, sem mexer. 8. Deixe cozinhar por 2-3 minutos at√© as bordas come√ßarem a firmar. 9. Com uma esp√°tula, levante delicadamente uma lateral para verificar se est√° dourada. 10. Distribua o cottage e a mussarela em metade da omelete. 11. Com cuidado, dobre a omelete ao meio usando uma esp√°tula larga. 12. Desligue o fogo e deixe descansar por 1 minuto para o queijo derreter. 13. Transfira para o prato, decore com tomate cereja cortado ao meio e or√©gano fresco.",
                        restrictions: []
                    },
                    { 
                        name: "Bowl Proteico de Iogurte Grego", 
                        calories: 420, 
                        ingredients: ["200g de iogurte grego natural", "30g de whey protein vanilla", "2 colheres de sopa de granola sem a√ß√∫car", "1 colher de sopa de pasta de amendoim integral", "1/2 banana fatiada", "1 colher de sopa de sementes de chia", "5 am√™ndoas picadas", "Canela em p√≥"], 
                        instructions: "1. Retire o iogurte grego da geladeira 15 minutos antes para n√£o ficar muito gelado. 2. Em uma tigela m√©dia, coloque o iogurte grego e o whey protein. 3. Com um fouet ou garfo, misture vigorosamente por 2 minutos at√© obter uma textura completamente homog√™nea e cremosa, sem grumos. 4. Adicione a pasta de amendoim em pequenas por√ß√µes e misture levemente com movimentos circulares para criar um belo efeito marmorizado. 5. Corte a banana em fatias de 0,5cm de espessura, em formato diagonal para maior eleg√¢ncia. 6. Pique grosseiramente as am√™ndoas com uma faca bem afiada. 7. Em uma tigela de vidro ou cer√¢mica bonita, despeje a mistura de iogurte. 8. Disponha as fatias de banana em formato de leque em um lado do bowl. 9. Polvilhe a granola do lado oposto, criando contraste visual. 10. Espalhe as sementes de chia uniformemente por toda superf√≠cie. 11. Finalize com as am√™ndoas picadas no centro e uma generosa pitada de canela em p√≥. 12. Sirva imediatamente com uma colher de sobremesa dourada ou de madeira para experi√™ncia completa.",
                        restrictions: ['lactose', 'nuts']
                    },
                    { 
                        name: "Panqueca de Aveia com Frutas Vermelhas", 
                        calories: 350, 
                        ingredients: ["1/2 x√≠cara de aveia em flocos", "2 ovos inteiros", "1 banana pequena madura", "1/4 x√≠cara de leite de am√™ndoas", "1 colher de ch√° de fermento em p√≥", "1/2 x√≠cara de mix de frutas vermelhas", "1 colher de sopa de mel", "Canela em p√≥", "Ess√™ncia de baunilha"], 
                        instructions: "1. No liquidificador, bata a aveia at√© virar farinha fina. 2. Adicione os ovos, banana, leite de am√™ndoas, fermento e uma pitada de canela. 3. Bata por 1 minuto at√© formar uma massa lisa e homog√™nea. 4. Deixe descansar por 5 minutos para hidratar a aveia. 5. Aque√ßa uma frigideira antiaderente pequena em fogo baixo. 6. Despeje 1/3 da massa formando um c√≠rculo perfeito. 7. Cozinhe por 3 minutos at√© formar bolhinhas na superf√≠cie. 8. Vire com cuidado e cozinhe por mais 2 minutos. 9. Repita o processo com o restante da massa. 10. Empilhe as panquecas no prato, intercalando com frutas vermelhas. 11. Regue com mel morno e polvilhe canela. Rica em fibras e antioxidantes naturais.",
                        restrictions: ['gluten', 'lactose']
                    },
                    { 
                        name: "Smoothie Bowl Verde Detox", 
                        calories: 320, 
                        ingredients: ["1 x√≠cara de espinafre baby", "1/2 abacate maduro", "1 banana congelada", "1/2 x√≠cara de leite de coco", "1 colher de sopa de sementes de chia", "1 colher de ch√° de spirulina", "1 kiwi fatiado", "2 colheres de sopa de coco ralado", "Granola sem gl√∫ten"], 
                        instructions: "1. No liquidificador, bata espinafre, abacate, banana e leite de coco at√© ficar cremoso. 2. Adicione spirulina e bata novamente. 3. Despeje em uma tigela. 4. Decore com kiwi, chia, coco ralado e granola. 5. Sirva imediatamente. Rico em antioxidantes e fibras.",
                        restrictions: ['gluten', 'lactose']
                    },
                    { 
                        name: "P√£o de Banana Proteico", 
                        calories: 280, 
                        ingredients: ["2 bananas maduras", "2 ovos", "1/4 x√≠cara de farinha de am√™ndoas", "2 colheres de sopa de whey protein", "1 colher de ch√° de fermento", "Canela", "Nozes picadas"], 
                        instructions: "1. Amasse as bananas em uma tigela. 2. Adicione ovos batidos e misture. 3. Incorpore farinha de am√™ndoas, whey protein, fermento e canela. 4. Despeje em forminhas individuais. 5. Asse a 180¬∞C por 20 minutos. 6. Decore com nozes picadas. Sem gl√∫ten e rico em prote√≠nas.",
                        restrictions: ['gluten', 'lactose']
                    },
                    { 
                        name: "Mingau de Quinoa com Frutas", 
                        calories: 340, 
                        ingredients: ["1/2 x√≠cara de quinoa em flocos", "1 x√≠cara de leite vegetal", "1 banana amassada", "1 colher de sopa de pasta de amendoim", "Frutas vermelhas", "Sementes de girassol", "Mel"], 
                        instructions: "1. Cozinhe a quinoa em flocos com leite vegetal por 5 minutos. 2. Adicione banana amassada e pasta de amendoim. 3. Mexa at√© ficar cremoso. 4. Sirva com frutas vermelhas e sementes. 5. Adoce com mel se desejar. Sem gl√∫ten e vegano.",
                        restrictions: ['gluten', 'lactose', 'vegetarian', 'vegan']
                    }
                ],
                'lanche-manha': [
                    { 
                        name: "Smoothie Verde Detox", 
                        calories: 180, 
                        ingredients: ["1 x√≠cara de espinafre baby", "1/2 abacate maduro", "1 ma√ß√£ verde sem casca", "1 colher de sopa de gengibre fresco ralado", "1 x√≠cara de √°gua de coco", "Suco de 1/2 lim√£o", "1 colher de ch√° de mel", "Gelo a gosto"], 
                        instructions: "Lave bem o espinafre e corte a ma√ß√£ em peda√ßos. No liquidificador, adicione primeiro a √°gua de coco, depois o espinafre, abacate, ma√ß√£ e gengibre. Bata por 1 minuto at√© ficar cremoso. Adicione o suco de lim√£o, mel e gelo, batendo novamente por 30 segundos. Sirva imediatamente em copo alto. Rico em fibras, vitaminas e antioxidantes naturais." 
                    }
                ],
                'almoco': [
                    { 
                        name: "Salm√£o Grelhado com Quinoa e Legumes", 
                        calories: 520, 
                        ingredients: ["180g de fil√© de salm√£o fresco", "3/4 x√≠cara de quinoa tricolor", "1 x√≠cara de br√≥colis", "1/2 abobrinha m√©dia", "1/4 x√≠cara de cenoura baby", "2 colheres de sopa de azeite extra virgem", "2 dentes de alho", "Sal rosa e pimenta do reino", "Ervas finas (tomilho e alecrim)", "Suco de 1/2 lim√£o", "1 colher de ch√° de gergelim"], 
                        instructions: "1. Lave a quinoa e cozinhe em caldo de legumes por 15 minutos at√© ficar al dente. 2. Tempere o salm√£o com sal, pimenta, ervas e metade do azeite, deixe marinar por 15 minutos. 3. Corte os legumes em peda√ßos uniformes. 4. Grelhe o salm√£o em frigideira bem quente por 4 minutos de cada lado, mantendo o centro rosado. 5. Refogue o alho no azeite restante, adicione os legumes e cozinhe por 8 minutos mantendo a textura crocante. 6. Sirva o salm√£o sobre a quinoa, acompanhe com legumes e finalize com suco de lim√£o e gergelim. Excelente fonte de √¥mega-3 e prote√≠nas completas.",
                        restrictions: ['seafood']
                    },
                    { 
                        name: "Peito de Frango com Batata Doce Assada", 
                        calories: 485, 
                        ingredients: ["200g de peito de frango", "1 batata doce m√©dia", "1 x√≠cara de vagem", "1/2 piment√£o vermelho", "2 colheres de sopa de azeite", "1 colher de ch√° de p√°prica doce", "Alho e cebola", "Sal rosa", "Alecrim fresco"], 
                        instructions: "1. Tempere o frango com sal, p√°prica e alecrim, deixe marinar por 20 minutos. 2. Corte a batata doce em cubos e asse no forno a 200¬∞C por 25 minutos. 3. Grelhe o frango por 6 minutos de cada lado. 4. Refogue a vagem e piment√£o rapidamente. 5. Monte o prato com o frango fatiado, batata doce e legumes. Rico em prote√≠nas magras e carboidratos complexos.",
                        restrictions: []
                    },
                    { 
                        name: "Bowl Vegano de Gr√£o-de-Bico", 
                        calories: 450, 
                        ingredients: ["1 x√≠cara de gr√£o-de-bico cozido", "1/2 x√≠cara de quinoa", "1 x√≠cara de espinafre", "1/2 abacate", "1 tomate", "1/4 pepino", "2 colheres de sopa de tahine", "Suco de lim√£o", "Azeite", "Cominho"], 
                        instructions: "1. Cozinhe a quinoa em caldo de legumes. 2. Tempere o gr√£o-de-bico com cominho e azeite. 3. Prepare o molho de tahine com lim√£o. 4. Monte o bowl com quinoa, gr√£o-de-bico, vegetais e abacate. 5. Regue com molho de tahine. Completo em prote√≠nas vegetais.",
                        restrictions: ['vegetarian', 'vegan', 'lactose']
                    },
                    { 
                        name: "Fil√© de Til√°pia com Arroz de Couve-flor", 
                        calories: 380, 
                        ingredients: ["180g de fil√© de til√°pia", "1 couve-flor m√©dia", "1 x√≠cara de br√≥colis", "2 colheres de sopa de azeite", "Alho", "Cebola", "Salsinha", "Lim√£o", "Sal e pimenta"], 
                        instructions: "1. Processe a couve-flor at√© ficar como arroz. 2. Tempere o peixe com sal, pimenta e lim√£o. 3. Grelhe o peixe por 3 minutos de cada lado. 4. Refogue a couve-flor processada com alho e cebola. 5. Cozinhe o br√≥colis no vapor. 6. Sirva o peixe com arroz de couve-flor e br√≥colis. Low carb e rico em prote√≠nas.",
                        restrictions: ['low-carb', 'keto', 'seafood']
                    },
                    { 
                        name: "Curry de Lentilha com Vegetais", 
                        calories: 420, 
                        ingredients: ["1 x√≠cara de lentilha vermelha", "1 lata de leite de coco", "1 cebola", "2 dentes de alho", "1 peda√ßo de gengibre", "1 colher de sopa de curry", "1 x√≠cara de espinafre", "1 tomate", "Coentro fresco"], 
                        instructions: "1. Refogue cebola, alho e gengibre. 2. Adicione curry e tomate, cozinhe por 2 minutos. 3. Acrescente lentilha e leite de coco. 4. Cozinhe por 15 minutos at√© a lentilha amolecer. 5. Adicione espinafre no final. 6. Finalize with coentro fresco. Vegano e rico em prote√≠nas.",
                        restrictions: ['vegetarian', 'vegan', 'lactose', 'gluten']
                    },
                    { 
                        name: "Hamb√∫rguer de Gr√£o-de-Bico", 
                        calories: 390, 
                        ingredients: ["1 x√≠cara de gr√£o-de-bico cozido", "1/4 x√≠cara de aveia", "1 cebola pequena", "2 dentes de alho", "1 colher de sopa de tahine", "Cominho", "P√°prica", "Salsa", "Alface", "Tomate"], 
                        instructions: "1. Amasse o gr√£o-de-bico deixando alguns peda√ßos. 2. Misture com aveia, cebola, alho e temperos. 3. Forme hamb√∫rgueres e grelhe por 4 minutos de cada lado. 4. Sirva com salada fresca. 5. Acompanhe com molho de tahine. Vegano e sem gl√∫ten.",
                        restrictions: ['vegetarian', 'vegan', 'lactose', 'gluten']
                    }
                ],
                'lanche-tarde': [
                    { 
                        name: "Mix de Castanhas e Frutas Secas", 
                        calories: 220, 
                        ingredients: ["2 colheres de sopa de castanha do Brasil", "1 colher de sopa de am√™ndoas", "1 colher de sopa de nozes", "2 colheres de sopa de uvas passas", "1 colher de sopa de damasco seco picado"], 
                        instructions: "Misture todos os ingredientes em um recipiente. Consuma como lanche energ√©tico. Rico em gorduras boas, fibras e antioxidantes. Por√ß√£o ideal para manter a energia entre as refei√ß√µes principais." 
                    }
                ],
                'janta': [
                    { 
                        name: "Frango Grelhado com Batata Doce e Salada", 
                        calories: 420, 
                        ingredients: ["180g de peito de frango", "1 batata doce pequena", "2 x√≠caras de mix de folhas verdes", "1/2 tomate", "1/4 pepino", "2 colheres de sopa de azeite extra virgem", "1 colher de sopa de vinagre bals√¢mico", "Sal rosa e pimenta", "Ervas proven√ßais", "1 colher de ch√° de mostarda dijon"], 
                        instructions: "1. Tempere o frango com sal, pimenta e ervas proven√ßais, deixe marinar por 15 minutos. 2. Corte a batata doce em fatias e asse no forno a 180¬∞C por 20 minutos. 3. Grelhe o frango em frigideira antiaderente por 6 minutos de cada lado at√© dourar bem. 4. Prepare a salada com folhas, tomate e pepino. 5. Fa√ßa um molho com azeite, vinagre e mostarda. 6. Sirva o frango fatiado com batata doce assada e salada fresca. Refei√ß√£o leve, nutritiva e rica em prote√≠nas.",
                        restrictions: []
                    },
                    { 
                        name: "Peixe Assado com Legumes Mediterr√¢neos", 
                        calories: 380, 
                        ingredients: ["180g de fil√© de til√°pia", "1 abobrinha m√©dia", "1/2 berinjela", "1 tomate", "1/2 cebola roxa", "3 colheres de sopa de azeite", "2 dentes de alho", "Or√©gano e manjeric√£o", "Sal e pimenta", "Suco de lim√£o"], 
                        instructions: "1. Corte todos os legumes em fatias grossas. 2. Tempere o peixe com sal, pimenta, ervas e suco de lim√£o. 3. Em uma assadeira, disponha os legumes temperados com azeite, alho e ervas. 4. Asse por 15 minutos a 200¬∞C. 5. Adicione o peixe por cima e asse por mais 12 minutos. 6. Finalize com azeite e ervas frescas. Prato completo, saud√°vel e saboroso.",
                        restrictions: ['seafood']
                    },
                    { 
                        name: "Tofu Grelhado com Vegetais Asi√°ticos", 
                        calories: 350, 
                        ingredients: ["200g de tofu firme", "1 x√≠cara de br√≥colis", "1/2 piment√£o vermelho", "1 cenoura", "2 colheres de sopa de molho shoyu", "1 colher de sopa de √≥leo de gergelim", "1 dente de alho", "Gengibre", "Cebolinha"], 
                        instructions: "1. Corte o tofu em fatias e grelhe at√© dourar. 2. Refogue os vegetais no wok com alho e gengibre. 3. Tempere com shoyu e √≥leo de gergelim. 4. Sirva o tofu com os vegetais. 5. Finalize com cebolinha picada. Vegano e rico em prote√≠nas.",
                        restrictions: ['vegetarian', 'vegan', 'lactose']
                    },
                    { 
                        name: "Sopa de Lentilha com Vegetais", 
                        calories: 320, 
                        ingredients: ["1 x√≠cara de lentilha", "2 x√≠caras de caldo de legumes", "1 cenoura", "1 aipo", "1 cebola", "2 dentes de alho", "1 folha de louro", "Tomilho", "Azeite", "Sal e pimenta"], 
                        instructions: "1. Refogue cebola, alho, cenoura e aipo. 2. Adicione lentilha e caldo de legumes. 3. Tempere com louro e tomilho. 4. Cozinhe por 25 minutos at√© a lentilha amolecer. 5. Ajuste temperos e sirva quente. Vegana e reconfortante.",
                        restrictions: ['vegetarian', 'vegan', 'lactose', 'gluten']
                    },
                    { 
                        name: "Omelete de Claras com Cogumelos", 
                        calories: 280, 
                        ingredients: ["4 claras de ovo", "1 ovo inteiro", "200g de cogumelos variados", "1 x√≠cara de espinafre", "2 colheres de sopa de queijo cottage", "Azeite", "Alho", "Ervas finas", "Sal e pimenta"], 
                        instructions: "1. Refogue cogumelos com alho at√© dourar. 2. Adicione espinafre e refogue rapidamente. 3. Bata claras com ovo inteiro e temperos. 4. Fa√ßa a omelete na frigideira. 5. Recheie com cogumelos e cottage. 6. Dobre e sirva quente. Leve e proteica.",
                        restrictions: ['lactose', 'low-carb']
                    },
                    { 
                        name: "Salada Completa com Gr√£o-de-Bico", 
                        calories: 390, 
                        ingredients: ["1 x√≠cara de gr√£o-de-bico cozido", "2 x√≠caras de mix de folhas", "1/2 abacate", "1 tomate", "1/4 pepino", "2 colheres de sopa de sementes de ab√≥bora", "Molho de tahine", "Lim√£o", "Azeite"], 
                        instructions: "1. Tempere o gr√£o-de-bico com cominho e azeite. 2. Prepare o molho de tahine com lim√£o. 3. Monte a salada com folhas, vegetais e abacate. 4. Adicione gr√£o-de-bico e sementes. 5. Regue com molho de tahine. Completa e nutritiva.",
                        restrictions: ['vegetarian', 'vegan', 'lactose', 'gluten']
                    }
                ],
                'ceia': [
                    { 
                        name: "Ch√° de Camomila com Biscoito de Aveia", 
                        calories: 120, 
                        ingredients: ["1 sach√™ de ch√° de camomila", "2 biscoitos integrais de aveia", "1 colher de ch√° de mel"], 
                        instructions: "Prepare o ch√° de camomila com √°gua quente por 5 minutos. Adoce com mel se desejar. Acompanhe com os biscoitos de aveia. Ideal para relaxar antes de dormir." 
                    }
                ]
            },
            week2: {
                'cafe-da-manha': [
                    { 
                        name: "A√ßa√≠ Bowl Proteico", 
                        calories: 450, 
                        ingredients: ["1 polpa de a√ßa√≠ (100g)", "1/2 banana congelada", "30g de whey protein a√ßa√≠", "2 colheres de sopa de granola proteica", "1 colher de sopa de pasta de amendoim", "5 morangos fatiados", "1 colher de sopa de sementes de girassol", "10 am√™ndoas laminadas"], 
                        instructions: "Bata a polpa de a√ßa√≠ com a banana congelada e whey protein at√© formar um creme espesso e homog√™neo. Despeje em uma tigela e decore com granola proteica, pasta de amendoim, morangos, sementes e am√™ndoas. Rico em antioxidantes, prote√≠nas e energia natural para o dia." 
                    },
                    { 
                        name: "Tapioca Proteica com Queijo e Ovo", 
                        calories: 380, 
                        ingredients: ["3 colheres de sopa de goma de tapioca", "1 ovo inteiro", "30g de queijo minas frescal", "1 fatia de peito de peru", "1 tomate cereja", "Or√©gano", "Azeite de oliva"], 
                        instructions: "Hidrate a tapioca em frigideira antiaderente at√© formar uma massa. Vire e adicione queijo, peru e tomate de um lado. Dobre ao meio. Em outra frigideira, frite o ovo. Sirva a tapioca com o ovo por cima, regue com azeite e or√©gano. Combina√ß√£o perfeita de carboidratos e prote√≠nas." 
                    }
                ],
                'lanche-manha': [
                    { 
                        name: "Iogurte com Chia e Frutas", 
                        calories: 195, 
                        ingredients: ["1 pote de iogurte natural desnatado", "1 colher de sopa de sementes de chia", "1/2 manga picada", "1 colher de ch√° de mel", "Hortel√£ fresca"], 
                        instructions: "Misture o iogurte com as sementes de chia e deixe descansar por 15 minutos. Adicione a manga e mel. Decore com hortel√£. Fonte de probi√≥ticos e √¥mega-3." 
                    }
                ],
                'almoco': [
                    { 
                        name: "Risotto de Quinoa com Cogumelos e Frango", 
                        calories: 520, 
                        ingredients: ["1 x√≠cara de quinoa", "150g de peito de frango em cubos", "200g de cogumelos variados", "1/2 cebola", "2 dentes de alho", "2 x√≠caras de caldo de frango", "2 colheres de sopa de azeite", "30g de queijo parmes√£o", "Salsa e tomilho"], 
                        instructions: "Tempere e doure o frango em cubos, reserve. Refogue cebola e alho no azeite. Adicione quinoa e torre por 2 minutos. Acrescente caldo aos poucos, mexendo sempre por 15 minutos. Refogue os cogumelos separadamente. Incorpore frango e cogumelos ao risotto, finalize com queijo e ervas. Prato completo e nutritivo." 
                    },
                    { 
                        name: "Fil√© de Peixe com Pur√™ de Mandioquinha", 
                        calories: 465, 
                        ingredients: ["180g de fil√© de pescada", "2 mandioquinhas m√©dias", "1 x√≠cara de espinafre", "2 colheres de sopa de leite desnatado", "2 colheres de sopa de azeite", "Alho, sal e pimenta", "Lim√£o", "Ervas finas"], 
                        instructions: "Cozinhe as mandioquinhas at√© ficarem macias, amasse com leite e azeite. Tempere o peixe com sal, pimenta e ervas, grelhe por 3 minutos de cada lado. Refogue o espinafre rapidamente. Sirva o peixe sobre o pur√™ acompanhado do espinafre, finalize com lim√£o." 
                    }
                ],
                'lanche-tarde': [
                    { 
                        name: "Vitamina de Abacate", 
                        calories: 240, 
                        ingredients: ["1/2 abacate", "1 copo de leite de am√™ndoas", "1 colher de sopa de cacau em p√≥", "1 colher de ch√° de mel", "Gelo"], 
                        instructions: "Bata todos os ingredientes no liquidificador at√© ficar cremoso. Sirva gelado. Rico em gorduras boas e antioxidantes." 
                    }
                ],
                'janta': [
                    { 
                        name: "Peixe ao Papillote com Legumes", 
                        calories: 385, 
                        ingredients: ["180g de fil√© de pescada", "1 abobrinha em fatias", "1 tomate em rodelas", "1/2 piment√£o amarelo", "1 cebola pequena", "Ervas frescas (dill e salsa)", "2 colheres de sopa de azeite", "Lim√£o", "Sal rosa e pimenta"], 
                        instructions: "Tempere o peixe com sal, pimenta e ervas. Em papel alum√≠nio, disponha o peixe sobre uma cama de legumes temperados com azeite. Feche bem formando um papillote e asse por 22 minutos a 180¬∞C. Finalize com lim√£o fresco. M√©todo que preserva todos os nutrientes e sabores naturais." 
                    },
                    { 
                        name: "Omelete de Claras com Legumes", 
                        calories: 280, 
                        ingredients: ["4 claras de ovo", "1 ovo inteiro", "1/2 abobrinha ralada", "1/4 piment√£o vermelho", "2 colheres de sopa de cottage", "1 colher de sopa de azeite", "Cebolinha", "Sal e pimenta"], 
                        instructions: "Bata as claras com o ovo inteiro, tempere com sal e pimenta. Refogue os legumes rapidamente no azeite. Despeje os ovos na frigideira, adicione legumes e cottage de um lado. Dobre a omelete e finalize com cebolinha. Jantar leve e proteico." 
                    }
                ],
                'ceia': [
                    { 
                        name: "Leite Dourado com C√∫rcuma", 
                        calories: 95, 
                        ingredients: ["1 x√≠cara de leite vegetal", "1/2 colher de ch√° de c√∫rcuma", "Pitada de pimenta preta", "Canela", "Mel"], 
                        instructions: "Aque√ßa o leite com c√∫rcuma e especiarias por 5 minutos. Adoce com mel. Propriedades anti-inflamat√≥rias e relaxantes." 
                    }
                ]
            }
        };

        // Current week selector
        let currentWeek = 'week1';
        
        // Get current recipe database
        function getCurrentRecipeDatabase() {
            return recipeWeeks[currentWeek];
        }

        // Daily tips
        const dailyTips = [
            "Beba √°gua regularmente ao longo do dia. A hidrata√ß√£o adequada √© fundamental para o bom funcionamento do organismo.",
            "Mastigue bem os alimentos. Isso facilita a digest√£o e aumenta a sensa√ß√£o de saciedade.",
            "Inclua fibras em suas refei√ß√µes. Elas ajudam no funcionamento intestinal e no controle da glicemia.",
            "Fa√ßa pequenas refei√ß√µes ao longo do dia. Isso mant√©m o metabolismo ativo e evita a fome excessiva.",
            "Consuma frutas e vegetais de cores variadas. Cada cor oferece nutrientes diferentes para o organismo."
        ];

        // Progress tracking system
        let dailyProgress = {
            meals: { current: 0, total: 6, lastUpdate: null },
            water: { current: 0, total: 2000, lastUpdate: null }, // in ml
            calories: { current: 0, total: 1800, lastUpdate: null }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadDailyProgress();
            if (currentUser) {
                showDashboard();
                startProgressUpdates();
            } else {
                showAuthArea();
            }
        });

        // Authentication functions
        function showAuthArea() {
            document.getElementById('auth-area').classList.remove('hidden');
            document.getElementById('dashboard').classList.add('hidden');
        }

        function showDashboard() {
            document.getElementById('auth-area').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            updateDashboardInfo();
            loadMealsPreview();
            loadDailyTip();
            showSection('inicio');
        }

        function showCreateAccount() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('create-account-step1').classList.remove('hidden');
        }

        function showLogin() {
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('create-account-step1').classList.add('hidden');
            document.getElementById('create-account-step2').classList.add('hidden');
        }

        function backToStep1() {
            document.getElementById('create-account-step2').classList.add('hidden');
            document.getElementById('create-account-step1').classList.remove('hidden');
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (users[email] && users[email].password === password) {
                currentUser = users[email];
                localStorage.setItem('vivasabor_current_user', JSON.stringify(currentUser));
                showDashboard();
                showSuccessMessage('Login realizado com sucesso!');
            } else {
                showErrorMessage('E-mail ou senha incorretos!');
            }
        }

        function handleCreateAccountStep1(event) {
            event.preventDefault();
            
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const phone = document.getElementById('register-phone').value;
            const password = document.getElementById('register-password').value;
            
            if (users[email]) {
                showErrorMessage('Este e-mail j√° est√° cadastrado!');
                return;
            }
            
            tempUserData = { name, email, phone, password };
            
            document.getElementById('create-account-step1').classList.add('hidden');
            document.getElementById('create-account-step2').classList.remove('hidden');
        }

        function handleCreateAccountStep2(event) {
            event.preventDefault();
            
            const age = parseInt(document.getElementById('register-age').value);
            const gender = document.getElementById('register-gender').value;
            const weight = parseFloat(document.getElementById('register-weight').value);
            const height = parseInt(document.getElementById('register-height').value);
            
            const restrictions = Array.from(document.querySelectorAll('input[name="register-restrictions"]:checked'))
                .map(checkbox => checkbox.value);
            
            const userData = {
                ...tempUserData,
                age,
                gender,
                weight,
                height,
                restrictions,
                plan: 'Gratuito',
                createdAt: new Date().toISOString()
            };
            
            users[userData.email] = userData;
            localStorage.setItem('vivasabor_users', JSON.stringify(users));
            
            currentUser = userData;
            localStorage.setItem('vivasabor_current_user', JSON.stringify(currentUser));
            
            tempUserData = {};
            showDashboard();
            showSuccessMessage('Conta criada com sucesso!');
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('vivasabor_current_user');
            showAuthArea();
            showSuccessMessage('Logout realizado com sucesso!');
        }

        // Dashboard functions
        function updateDashboardInfo() {
            if (!currentUser) return;
            
            document.getElementById('user-greeting').textContent = `Ol√°, ${currentUser.name.split(' ')[0]}!`;
            document.getElementById('user-plan').textContent = `Plano ${currentUser.plan}`;
            document.getElementById('menu-user-name').textContent = currentUser.name;
            document.getElementById('menu-user-email').textContent = currentUser.email;
            
            // Auto-fill NutriBox form
            document.getElementById('nutribox-name').value = currentUser.name;
            document.getElementById('nutribox-phone').value = currentUser.phone;
            
            // Show/hide premium features
            if (currentUser.plan === 'Premium') {
                document.getElementById('premium-discount').classList.remove('hidden');
                document.getElementById('premium-only-message').classList.add('hidden');
                document.getElementById('videos-premium-message').classList.add('hidden');
                document.getElementById('appointments-section').classList.remove('hidden');
                document.getElementById('videos-section').classList.remove('hidden');
            } else if (currentUser.plan === 'B√°sico') {
                document.getElementById('premium-discount').classList.add('hidden');
                document.getElementById('premium-only-message').classList.add('hidden');
                document.getElementById('videos-premium-message').classList.add('hidden');
                document.getElementById('appointments-section').classList.remove('hidden');
                document.getElementById('videos-section').classList.remove('hidden');
            } else {
                document.getElementById('premium-discount').classList.add('hidden');
                document.getElementById('premium-only-message').classList.add('hidden');
                document.getElementById('videos-premium-message').classList.add('hidden');
                document.getElementById('appointments-section').classList.add('hidden');
                document.getElementById('videos-section').classList.add('hidden');
            }
        }

        function showSection(section) {
            // Check if user has access to the section
            if (currentUser.plan === 'Gratuito' && section !== 'inicio') {
                showPlanSelectionModal();
                return;
            }
            
            // Hide all sections
            const sections = ['inicio', 'receitas', 'nutribox', 'consultas', 'video-aulas'];
            sections.forEach(s => {
                document.getElementById(`section-${s}`).classList.add('hidden');
                const navBtn = document.getElementById(`nav-${s}`);
                if (navBtn) {
                    navBtn.classList.remove('text-green-600', 'active');
                    navBtn.classList.add('text-gray-400');
                }
            });
            
            // Show selected section with animation
            const sectionElement = document.getElementById(`section-${section}`);
            sectionElement.classList.remove('hidden');
            sectionElement.classList.add('fade-in');
            
            const activeBtn = document.getElementById(`nav-${section}`);
            if (activeBtn) {
                activeBtn.classList.remove('text-gray-400');
                activeBtn.classList.add('text-green-600', 'active');
            }
            
            // Load section-specific content
            if (section === 'receitas') {
                loadRecipes();
            } else if (section === 'consultas') {
                loadAppointments();
            } else if (section === 'video-aulas') {
                loadVideos();
            }
        }

        // Progress management functions
        function loadDailyProgress() {
            const today = new Date().toDateString();
            const savedProgress = localStorage.getItem(`vivasabor_progress_${today}`);
            
            if (savedProgress) {
                dailyProgress = JSON.parse(savedProgress);
            } else {
                // Reset progress for new day
                dailyProgress = {
                    meals: { current: 0, total: 6, lastUpdate: null },
                    water: { current: 0, total: 2000, lastUpdate: null },
                    calories: { current: 0, total: 1800, lastUpdate: null }
                };
                saveDailyProgress();
            }
        }

        function saveDailyProgress() {
            const today = new Date().toDateString();
            localStorage.setItem(`vivasabor_progress_${today}`, JSON.stringify(dailyProgress));
        }

        function startProgressUpdates() {
            // Update progress every 30 seconds to simulate real-time tracking
            setInterval(updateProgressBars, 30000);
            
            // Simulate meal consumption based on time of day
            simulateRealtimeProgress();
            
            // Update bars immediately
            updateProgressBars();
        }

        function simulateRealtimeProgress() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const currentTime = hour * 60 + minute; // minutes since midnight
            
            // Meal times in minutes since midnight
            const mealTimes = {
                breakfast: 8 * 60,      // 08:00
                snack1: 10 * 60,        // 10:00
                lunch: 12.5 * 60,       // 12:30
                snack2: 15 * 60,        // 15:00
                dinner: 19 * 60,        // 19:00
                supper: 21 * 60         // 21:00
            };
            
            // Calculate meals consumed based on current time
            let mealsConsumed = 0;
            let caloriesConsumed = 0;
            
            if (currentTime >= mealTimes.breakfast) {
                mealsConsumed++;
                caloriesConsumed += 385; // Breakfast calories
            }
            if (currentTime >= mealTimes.snack1) {
                mealsConsumed++;
                caloriesConsumed += 180; // Morning snack calories
            }
            if (currentTime >= mealTimes.lunch) {
                mealsConsumed++;
                caloriesConsumed += 520; // Lunch calories
            }
            if (currentTime >= mealTimes.snack2) {
                mealsConsumed++;
                caloriesConsumed += 220; // Afternoon snack calories
            }
            if (currentTime >= mealTimes.dinner) {
                mealsConsumed++;
                caloriesConsumed += 420; // Dinner calories
            }
            if (currentTime >= mealTimes.supper) {
                mealsConsumed++;
                caloriesConsumed += 120; // Supper calories
            }
            
            // Water consumption increases throughout the day
            let waterConsumed = 0;
            if (currentTime >= 7 * 60) waterConsumed += 250;  // 07:00 - 250ml
            if (currentTime >= 9 * 60) waterConsumed += 200;  // 09:00 - 200ml
            if (currentTime >= 11 * 60) waterConsumed += 300; // 11:00 - 300ml
            if (currentTime >= 13 * 60) waterConsumed += 250; // 13:00 - 250ml
            if (currentTime >= 15 * 60) waterConsumed += 200; // 15:00 - 200ml
            if (currentTime >= 17 * 60) waterConsumed += 300; // 17:00 - 300ml
            if (currentTime >= 19 * 60) waterConsumed += 250; // 19:00 - 250ml
            if (currentTime >= 21 * 60) waterConsumed += 250; // 21:00 - 250ml
            
            // Update progress
            dailyProgress.meals.current = Math.min(mealsConsumed, dailyProgress.meals.total);
            dailyProgress.water.current = Math.min(waterConsumed, dailyProgress.water.total);
            dailyProgress.calories.current = Math.min(caloriesConsumed, dailyProgress.calories.total);
            
            saveDailyProgress();
        }

        function updateProgressBars() {
            // Update meals progress
            const mealsPercent = (dailyProgress.meals.current / dailyProgress.meals.total) * 100;
            const mealsBar = document.querySelector('.progress-meals');
            if (mealsBar) {
                mealsBar.style.width = `${mealsPercent}%`;
            }
            document.querySelector('.meals-count').textContent = `${dailyProgress.meals.current}/${dailyProgress.meals.total}`;
            
            // Update water progress
            const waterPercent = (dailyProgress.water.current / dailyProgress.water.total) * 100;
            const waterBar = document.querySelector('.progress-water');
            if (waterBar) {
                waterBar.style.width = `${waterPercent}%`;
            }
            document.querySelector('.water-count').textContent = `${(dailyProgress.water.current / 1000).toFixed(1)}L`;
            
            // Update calories progress
            const caloriesPercent = (dailyProgress.calories.current / dailyProgress.calories.total) * 100;
            const caloriesBar = document.querySelector('.progress-calories');
            if (caloriesBar) {
                caloriesBar.style.width = `${caloriesPercent}%`;
            }
            document.querySelector('.calories-count').textContent = dailyProgress.calories.current.toLocaleString();
        }

        function addWaterIntake(amount) {
            dailyProgress.water.current = Math.min(dailyProgress.water.current + amount, dailyProgress.water.total);
            saveDailyProgress();
            updateProgressBars();
            showSuccessMessage(`+${amount}ml de √°gua adicionado!`);
        }

        function markMealConsumed() {
            if (dailyProgress.meals.current < dailyProgress.meals.total) {
                dailyProgress.meals.current++;
                saveDailyProgress();
                updateProgressBars();
                showSuccessMessage('Refei√ß√£o marcada como consumida!');
            }
        }

        function loadMealsPreview() {
            const container = document.getElementById('meals-preview');
            
            // Check if user has access to meal previews
            if (currentUser.plan === 'Gratuito') {
                container.innerHTML = `
                    <div class="col-span-full bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-xl p-8 text-center">
                        <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-yellow-100">
                            <span class="text-2xl">üîí</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Pr√©via das Refei√ß√µes Bloqueada</h3>
                        <p class="text-gray-600 mb-4">Assine um plano para ver suas refei√ß√µes personalizadas do dia</p>
                        <button onclick="showPlanSelectionModal()" class="btn-primary px-6 py-2 rounded-lg font-bold shadow-lg">
                            ‚ú® Ver Planos
                        </button>
                    </div>
                `;
                return;
            }
            
            const now = new Date();
            const hour = now.getHours();
            
            // Determine next meals based on current time
            let meals = [];
            
            if (hour < 8) {
                meals = [
                    { name: 'Caf√© da Manh√£', time: '08:00', recipe: 'Omelete Proteica com Espinafre', status: 'pr√≥xima' },
                    { name: 'Almo√ßo', time: '12:30', recipe: 'Salm√£o Grelhado com Quinoa', status: 'pendente' },
                    { name: 'Jantar', time: '19:00', recipe: 'Frango Grelhado com Batata Doce', status: 'pendente' }
                ];
            } else if (hour < 12) {
                meals = [
                    { name: 'Caf√© da Manh√£', time: '08:00', recipe: 'Omelete Proteica com Espinafre', status: 'conclu√≠da' },
                    { name: 'Almo√ßo', time: '12:30', recipe: 'Salm√£o Grelhado com Quinoa', status: 'pr√≥xima' },
                    { name: 'Jantar', time: '19:00', recipe: 'Frango Grelhado com Batata Doce', status: 'pendente' }
                ];
            } else if (hour < 19) {
                meals = [
                    { name: 'Caf√© da Manh√£', time: '08:00', recipe: 'Omelete Proteica com Espinafre', status: 'conclu√≠da' },
                    { name: 'Almo√ßo', time: '12:30', recipe: 'Salm√£o Grelhado com Quinoa', status: 'conclu√≠da' },
                    { name: 'Jantar', time: '19:00', recipe: 'Frango Grelhado com Batata Doce', status: 'pr√≥xima' }
                ];
            } else {
                meals = [
                    { name: 'Caf√© da Manh√£', time: '08:00', recipe: 'Omelete Proteica com Espinafre', status: 'conclu√≠da' },
                    { name: 'Almo√ßo', time: '12:30', recipe: 'Salm√£o Grelhado com Quinoa', status: 'conclu√≠da' },
                    { name: 'Jantar', time: '19:00', recipe: 'Frango Grelhado com Batata Doce', status: 'conclu√≠da' }
                ];
            }
            
            container.innerHTML = meals.map(meal => {
                let statusClass = '';
                let statusIcon = '';
                
                switch(meal.status) {
                    case 'conclu√≠da':
                        statusClass = 'bg-green-50 border-green-200';
                        statusIcon = '‚úÖ';
                        break;
                    case 'pr√≥xima':
                        statusClass = 'bg-blue-50 border-blue-200';
                        statusIcon = '‚è∞';
                        break;
                    default:
                        statusClass = 'bg-gray-50 border-gray-200';
                        statusIcon = '‚è≥';
                }
                
                return `
                    <div class="${statusClass} border rounded-lg p-4 transition-all duration-300">
                        <div class="flex items-center justify-between mb-2">
                            <div>
                                <h4 class="font-semibold text-gray-800">${meal.name}</h4>
                                <p class="text-sm text-gray-600">${meal.time}</p>
                            </div>
                            <span class="text-lg">${statusIcon}</span>
                        </div>
                        <p class="text-sm text-gray-700">${meal.recipe}</p>
                        ${meal.status === 'pr√≥xima' ? `
                            <button onclick="markMealConsumed()" class="mt-2 text-xs bg-green-600 text-white px-3 py-1 rounded-full hover:bg-green-700 transition-colors">
                                Marcar como consumida
                            </button>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function loadDailyTip() {
            const tipElement = document.getElementById('daily-tip');
            const randomTip = dailyTips[Math.floor(Math.random() * dailyTips.length)];
            tipElement.textContent = randomTip;
        }

        function loadRecipes() {
            const container = document.getElementById('recipes-grid');
            const allRecipes = [];
            const recipeDatabase = getCurrentRecipeDatabase();
            const userRestrictions = currentUser?.restrictions || [];
            
            Object.keys(recipeDatabase).forEach(mealType => {
                recipeDatabase[mealType].forEach(recipe => {
                    // Filter recipes based on user restrictions
                    const hasConflictingRestriction = recipe.restrictions && recipe.restrictions.some(restriction => 
                        userRestrictions.includes(restriction)
                    );
                    
                    if (!hasConflictingRestriction) {
                        allRecipes.push({ ...recipe, type: mealType });
                    }
                });
            });
            
            container.innerHTML = allRecipes.map((recipe, index) => `
                <div class="recipe-card card-elegant rounded-2xl p-6 fade-in" style="animation-delay: ${index * 0.1}s;">
                    <div class="flex justify-between items-start mb-6">
                        <h3 class="text-xl font-bold text-gradient">${recipe.name}</h3>
                        <span class="px-3 py-1 gradient-secondary text-white text-sm font-bold rounded-full shadow-lg">${recipe.calories} kcal</span>
                    </div>
                    <div class="space-y-3 mb-6">
                        <h4 class="font-bold text-gray-700">Ingredientes:</h4>
                        <ul class="space-y-2">
                            ${recipe.ingredients.slice(0, 3).map(ing => `<li class="ingredient-item text-sm text-gray-600">${ing}</li>`).join('')}
                            ${recipe.ingredients.length > 3 ? `<li class="text-gray-400 text-sm ml-8">... e mais ${recipe.ingredients.length - 3} ingredientes</li>` : ''}
                        </ul>
                    </div>
                    <button onclick="showRecipeDetails('${recipe.name}', '${recipe.instructions}', '${recipe.ingredients.join(', ')}', ${recipe.calories})" class="w-full btn-primary py-3 rounded-xl font-bold shadow-lg">
                        üë®‚Äçüç≥ Ver Receita Completa
                    </button>
                </div>
            `).join('');
        }

        function generateNewRecipes() {
            // Switch to next week
            currentWeek = currentWeek === 'week1' ? 'week2' : 'week1';
            loadRecipes();
            loadMealsPreview();
            showSuccessMessage(`Receitas da Semana ${currentWeek === 'week1' ? '1' : '2'} carregadas! Novas op√ß√µes baseadas nas suas restri√ß√µes.`);
        }

        function filterRecipes(type) {
            // Update filter buttons
            document.querySelectorAll('[onclick^="filterRecipes"]').forEach(btn => {
                btn.className = 'px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300';
            });
            event.target.className = 'px-4 py-2 rounded-full text-sm font-medium bg-green-600 text-white';
            
            const container = document.getElementById('recipes-grid');
            
            if (type === 'all') {
                loadRecipes();
                return;
            }
            
            const recipeDatabase = getCurrentRecipeDatabase();
            const filteredRecipes = recipeDatabase[type] || [];
            
            container.innerHTML = filteredRecipes.map(recipe => `
                <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-800">${recipe.name}</h3>
                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">${recipe.calories} kcal</span>
                    </div>
                    <div class="space-y-2 mb-4">
                        <h4 class="font-semibold text-gray-700">Ingredientes:</h4>
                        <ul class="text-sm text-gray-600">
                            ${recipe.ingredients.slice(0, 3).map(ing => `<li>‚Ä¢ ${ing}</li>`).join('')}
                            ${recipe.ingredients.length > 3 ? `<li class="text-gray-400">... e mais ${recipe.ingredients.length - 3}</li>` : ''}
                        </ul>
                    </div>
                    <button onclick="showRecipeDetails('${recipe.name}', '${recipe.instructions}', '${recipe.ingredients.join(', ')}', ${recipe.calories})" class="w-full text-white py-2 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #8f864c;">
                        Ver Receita Completa
                    </button>
                </div>
            `).join('');
        }

        function showRecipeDetails(name, instructions, ingredients, calories) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            
            // Process instructions to create numbered steps
            const processedInstructions = instructions.split(/(?=\d+\.)/).filter(step => step.trim());
            let instructionSteps = [];
            
            if (processedInstructions.length > 1) {
                // Already numbered
                instructionSteps = processedInstructions.map(step => step.trim()).filter(step => step);
            } else {
                // Split by sentence and number them
                const sentences = instructions.split(/(?<=[.!?])\s+/).filter(s => s.trim());
                instructionSteps = sentences.map((sentence, index) => `${index + 1}. ${sentence.trim()}`);
            }
            
            modal.innerHTML = `
                <div class="glass-effect rounded-3xl shadow-2xl p-10 max-w-6xl w-full max-h-screen overflow-y-auto bounce-in">
                    <div class="text-center mb-10">
                        <h2 class="text-4xl font-bold text-gradient mb-4">${name}</h2>
                        <div class="inline-block px-6 py-2 gradient-secondary text-white font-bold rounded-full shadow-lg floating">${calories} kcal</div>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-10">
                        <!-- Ingredientes -->
                        <div class="card-elegant rounded-2xl p-8 slide-up">
                            <div class="flex items-center mb-8">
                                <div class="w-12 h-12 rounded-full gradient-primary flex items-center justify-center mr-4 shadow-lg">
                                    <span class="text-white text-xl">üõí</span>
                                </div>
                                <h3 class="text-2xl font-bold text-gradient">Ingredientes</h3>
                            </div>
                            <div class="space-y-4">
                                ${ingredients.split(', ').map((ingredient, index) => `
                                    <div class="flex items-start space-x-4 p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors" style="animation-delay: ${index * 0.1}s;">
                                        <div class="w-6 h-6 rounded-full gradient-accent flex items-center justify-center flex-shrink-0 mt-1">
                                            <span class="text-white text-xs font-bold">${index + 1}</span>
                                        </div>
                                        <span class="text-gray-700 font-medium leading-relaxed">${ingredient.trim()}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <!-- Modo de Preparo -->
                        <div class="card-elegant rounded-2xl p-8 slide-up" style="animation-delay: 0.2s;">
                            <div class="flex items-center mb-8">
                                <div class="w-12 h-12 rounded-full gradient-primary flex items-center justify-center mr-4 shadow-lg">
                                    <span class="text-white text-xl">üë®‚Äçüç≥</span>
                                </div>
                                <h3 class="text-2xl font-bold text-gradient">Modo de Preparo</h3>
                            </div>
                            <div class="space-y-6">
                                ${instructionSteps.map((step, index) => {
                                    const cleanStep = step.replace(/^\d+\.\s*/, '').trim();
                                    return `
                                        <div class="relative pl-16 pb-6 border-l-2 border-gray-200 last:border-l-0" style="animation: slideUp 0.6s ease-out ${index * 0.1}s both;">
                                            <div class="absolute -left-6 top-0 w-12 h-12 rounded-full gradient-secondary flex items-center justify-center shadow-lg">
                                                <span class="text-white font-bold text-lg">${index + 1}</span>
                                            </div>
                                            <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                                                <p class="text-gray-700 leading-relaxed font-medium">${cleanStep}</p>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dicas Extras -->
                    <div class="mt-10 card-elegant rounded-2xl p-8 slide-up" style="animation-delay: 0.4s;">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 rounded-full gradient-accent flex items-center justify-center mr-4 shadow-lg">
                                <span class="text-white text-lg">üí°</span>
                            </div>
                            <h4 class="text-xl font-bold text-gradient">Dicas do Chef</h4>
                        </div>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="bg-gradient-to-br from-green-50 to-blue-50 p-4 rounded-xl">
                                <p class="text-sm text-gray-700"><strong>‚è±Ô∏è Tempo:</strong> Prepare todos os ingredientes antes de come√ßar para agilizar o processo.</p>
                            </div>
                            <div class="bg-gradient-to-br from-yellow-50 to-orange-50 p-4 rounded-xl">
                                <p class="text-sm text-gray-700"><strong>üî• Temperatura:</strong> Mantenha o fogo adequado para n√£o queimar os alimentos.</p>
                            </div>
                            <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-4 rounded-xl">
                                <p class="text-sm text-gray-700"><strong>‚ú® Apresenta√ß√£o:</strong> Sirva imediatamente para manter sabor e textura ideais.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-10 text-center">
                        <button onclick="this.closest('.fixed').remove()" class="btn-primary px-12 py-4 rounded-xl font-bold text-lg shadow-lg hover:scale-105 transition-transform">
                            ‚ú® Fechar Receita
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // NutriBox functions
        function updateNutriBoxTotal() {
            const selectedItems = document.querySelectorAll('input[name="nutribox-meals"]:checked');
            const summaryContainer = document.getElementById('selected-items-summary');
            let subtotal = 0;
            let itemsHtml = '';
            
            if (selectedItems.length === 0) {
                summaryContainer.innerHTML = '<p class="text-gray-600 text-sm">Selecione os itens acima para ver o resumo</p>';
                document.getElementById('subtotal-cost').textContent = 'R$ 0,00';
                document.getElementById('total-cost').textContent = 'R$ 0,00';
                return;
            }
            
            selectedItems.forEach(item => {
                const price = parseFloat(item.dataset.price);
                subtotal += price;
                
                let itemName = '';
                switch(item.value) {
                    case 'principais':
                        itemName = 'Refei√ß√µes Principais';
                        break;
                    case 'lanches':
                        itemName = 'Lanches e Ceia';
                        break;
                    case 'sobremesas':
                        itemName = 'Sobremesas';
                        break;
                }
                
                itemsHtml += `
                    <div class="flex justify-between text-sm mb-1">
                        <span>${itemName}</span>
                        <span>R$ ${price.toFixed(2)}</span>
                    </div>
                `;
            });
            
            summaryContainer.innerHTML = itemsHtml;
            document.getElementById('subtotal-cost').textContent = `R$ ${subtotal.toFixed(2)}`;
            
            // Calculate shipping
            const cep = document.getElementById('nutribox-cep').value;
            let shippingCost = cep ? 15.00 : 0;
            
            if (currentUser && currentUser.plan === 'Premium') {
                shippingCost = 0;
                document.getElementById('shipping-cost').textContent = `R$ ${shippingCost.toFixed(2)}`;
            } else {
                document.getElementById('shipping-cost').textContent = `R$ ${shippingCost.toFixed(2)}`;
            }
            
            // Calculate discount
            let discount = 0;
            if (currentUser && currentUser.plan === 'Premium') {
                discount = subtotal * 0.1; // 10% discount
                document.getElementById('premium-discount-nutribox').classList.remove('hidden');
                document.getElementById('discount-amount').textContent = `-R$ ${discount.toFixed(2)}`;
            } else {
                document.getElementById('premium-discount-nutribox').classList.add('hidden');
            }
            
            const total = subtotal + shippingCost - discount;
            document.getElementById('total-cost').textContent = `R$ ${total.toFixed(2)}`;
        }
        
        function calculateShipping() {
            updateNutriBoxTotal();
        }



        function handleNutriBoxOrder(event) {
            event.preventDefault();
            
            const selectedMeals = Array.from(document.querySelectorAll('input[name="nutribox-meals"]:checked'))
                .map(checkbox => checkbox.value);
            
            if (selectedMeals.length === 0) {
                showErrorMessage('Selecione pelo menos uma op√ß√£o!');
                return;
            }
            
            const cep = document.getElementById('nutribox-cep').value;
            
            // Calculate delivery time based on CEP distance simulation
            const deliveryTime = calculateDeliveryTime(cep);
            
            // Generate order number
            const orderNumber = 'VB' + Date.now().toString().slice(-6);
            
            // Hide form and show confirmation
            document.getElementById('nutribox-form').classList.add('hidden');
            document.getElementById('order-confirmation').classList.remove('hidden');
            
            // Update delivery info
            document.getElementById('delivery-time').textContent = deliveryTime;
            document.getElementById('order-number').textContent = orderNumber;
            
            showSuccessMessage('Pedido confirmado! Verifique os detalhes de entrega abaixo.');
        }
        
        function calculateDeliveryTime(cep) {
            // Remove formatting from CEP
            const cleanCep = cep.replace(/\D/g, '');
            const companyCep = '41800700'; // Company CEP without formatting
            
            if (!cleanCep || cleanCep.length !== 8) {
                return '4-6 horas';
            }
            
            // Calculate "distance" based on CEP difference (simulation)
            const cepDiff = Math.abs(parseInt(cleanCep.substring(0, 5)) - parseInt(companyCep.substring(0, 5)));
            
            let deliveryHours;
            if (cepDiff <= 250) {
                deliveryHours = 0.2; // 1h30min minimum
            } else if (cepDiff <= 500) {
                deliveryHours = 0.4;
            } else if (cepDiff <= 1000) {
                deliveryHours = 1.0;
            } else if (cepDiff <= 5000) {
                deliveryHours = 1.5;
            } else {
                deliveryHours = 2; // 1 day maximum
            }
            
            if (deliveryHours < 0.2) {
                return 'At√© 20min';
            } else if (deliveryHours <= 0.4) {
                return '21min - 40min';
            } else if (deliveryHours <= 1.0) {
                return '41min - 1h';
            } else if (deliveryHours <= 1.5) {
                return '1h - 1h30min';
            } else {
                return '1h31min - 2hrs';
            }
        }
        
        function resetNutriBoxForm() {
            // Show form and hide confirmation
            document.getElementById('nutribox-form').classList.remove('hidden');
            document.getElementById('order-confirmation').classList.add('hidden');
            
            // Reset form
            document.getElementById('nutribox-form').reset();
            
            // Restore auto-filled values
            document.getElementById('nutribox-name').value = currentUser.name;
            document.getElementById('nutribox-phone').value = currentUser.phone;
            
            // Reset totals
            updateNutriBoxTotal();
        }

        // Appointments functions
        function loadAppointments() {
            const container = document.getElementById('scheduled-appointments');
            const userAppointments = appointments[currentUser?.email] || [];
            
            // Add consultation limits info
            let limitsInfo = '';
            if (currentUser.plan === 'B√°sico') {
                const nutritionistAppointments = userAppointments.filter(app => app.type === 'Nutricionista');
                const remaining = Math.max(0, 1 - nutritionistAppointments.length);
                limitsInfo = `
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-blue-800 mb-2">üìã Limite do Plano B√°sico</h4>
                        <p class="text-blue-700 text-sm">
                            ‚Ä¢ Apenas consultas com Nutricionista<br>
                            ‚Ä¢ 1 consulta gratuita total<br>
                            ‚Ä¢ Consultas restantes: <strong>${remaining}</strong>
                        </p>
                        ${remaining === 0 ? '<p class="text-red-600 text-sm mt-2 font-semibold">‚ö†Ô∏è Limite atingido! Fa√ßa upgrade para Premium para mais consultas.</p>' : ''}
                    </div>
                `;
            } else if (currentUser.plan === 'Premium') {
                const currentMonth = new Date().getMonth();
                const currentYear = new Date().getFullYear();
                const thisMonthAppointments = userAppointments.filter(app => {
                    const appointmentDate = new Date(app.date);
                    return appointmentDate.getMonth() === currentMonth && 
                           appointmentDate.getFullYear() === currentYear;
                });
                const remaining = Math.max(0, 4 - thisMonthAppointments.length);
                limitsInfo = `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-green-800 mb-2">‚≠ê Plano Premium</h4>
                        <p class="text-green-700 text-sm">
                            ‚Ä¢ Todos os profissionais dispon√≠veis<br>
                            ‚Ä¢ At√© 4 consultas por m√™s<br>
                            ‚Ä¢ Consultas restantes este m√™s: <strong>${remaining}</strong>
                        </p>
                        ${remaining === 0 ? '<p class="text-orange-600 text-sm mt-2 font-semibold">‚ö†Ô∏è Limite mensal atingido! Aguarde o pr√≥ximo m√™s.</p>' : ''}
                    </div>
                `;
            }
            
            if (userAppointments.length === 0) {
                container.innerHTML = limitsInfo + '<p class="text-gray-500 text-center">Nenhuma consulta agendada</p>';
                return;
            }
            
            container.innerHTML = limitsInfo + userAppointments.map(appointment => `
                <div class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
                    <div>
                        <h4 class="font-semibold text-gray-800">${appointment.type}</h4>
                        <p class="text-sm text-gray-600">${formatDate(appointment.date)} √†s ${appointment.time}</p>
                        <span class="inline-block px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">${appointment.status}</span>
                    </div>
                    <button onclick="cancelAppointment('${appointment.id}')" class="text-red-600 hover:text-red-800 text-sm">
                        Cancelar
                    </button>
                </div>
            `).join('');
        }

        function scheduleAppointment(type) {
            if (currentUser.plan === 'Gratuito') {
                showErrorMessage('Agendamento de consultas dispon√≠vel apenas para usu√°rios com plano pago!');
                return;
            }
            
            // Check appointment limits
            const userAppointments = appointments[currentUser.email] || [];
            
            if (currentUser.plan === 'B√°sico') {
                // Basic plan: only 1 consultation with nutritionist, ever
                if (type !== 'Nutricionista') {
                    showErrorMessage('No plano B√°sico, voc√™ s√≥ pode agendar consultas com Nutricionista. Fa√ßa upgrade para Premium para acessar outros profissionais!');
                    return;
                }
                
                const nutritionistAppointments = userAppointments.filter(app => app.type === 'Nutricionista');
                if (nutritionistAppointments.length >= 1) {
                    showErrorMessage('Voc√™ j√° utilizou sua consulta gratuita com nutricionista do plano B√°sico. Fa√ßa upgrade para Premium para mais consultas!');
                    return;
                }
            } else if (currentUser.plan === 'Premium') {
                // Premium plan: up to 4 consultations per month
                const currentMonth = new Date().getMonth();
                const currentYear = new Date().getFullYear();
                
                const thisMonthAppointments = userAppointments.filter(app => {
                    const appointmentDate = new Date(app.date);
                    return appointmentDate.getMonth() === currentMonth && 
                           appointmentDate.getFullYear() === currentYear;
                });
                
                if (thisMonthAppointments.length >= 4) {
                    showErrorMessage('Voc√™ j√° atingiu o limite de 4 consultas mensais do plano Premium. Aguarde o pr√≥ximo m√™s para agendar mais consultas!');
                    return;
                }
            }
            
            currentAppointmentType = type;
            document.getElementById('appointment-modal-title').textContent = `Agendar Consulta - ${type}`;
            document.getElementById('appointment-modal').classList.remove('hidden');
            
            // Set minimum date to today (Brazil timezone)
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('appointment-date').min = today;
        }

        function closeAppointmentModal() {
            document.getElementById('appointment-modal').classList.add('hidden');
            document.getElementById('appointment-form').reset();
        }

        function handleAppointmentSubmit(event) {
            event.preventDefault();
            
            const date = document.getElementById('appointment-date').value;
            const time = document.getElementById('appointment-time').value;
            
            const appointmentData = {
                id: Date.now().toString(),
                type: currentAppointmentType,
                date,
                time,
                status: 'Agendado'
            };
            
            if (!appointments[currentUser.email]) {
                appointments[currentUser.email] = [];
            }
            
            appointments[currentUser.email].push(appointmentData);
            localStorage.setItem('vivasabor_appointments', JSON.stringify(appointments));
            
            closeAppointmentModal();
            loadAppointments();
            showSuccessMessage(`Consulta com ${currentAppointmentType} agendada para ${formatDate(date)} √†s ${time}!`);
        }

        function cancelAppointment(appointmentId) {
            if (!appointments[currentUser.email]) return;
            
            appointments[currentUser.email] = appointments[currentUser.email].filter(app => app.id !== appointmentId);
            localStorage.setItem('vivasabor_appointments', JSON.stringify(appointments));
            
            loadAppointments();
            showSuccessMessage('Consulta cancelada com sucesso!');
        }

        function formatDate(dateString) {
            const date = new Date(dateString + 'T00:00:00');
            return date.toLocaleDateString('pt-BR', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Videos functions
        function loadVideos() {
            if (currentUser.plan === 'Gratuito') return;
            
            const container = document.getElementById('videos-section');
            const videos = [
                { title: "Salada Nutritiva", duration: "8 min", emoji: "ü•ó" },
                { title: "Omelete Perfeita", duration: "12 min", emoji: "üç≥" },
                { title: "Sopa Caseira", duration: "15 min", emoji: "üç≤" },
                { title: "Smoothie Verde", duration: "6 min", emoji: "ü•§" },
                { title: "Peixe Grelhado", duration: "18 min", emoji: "üêü" },
                { title: "Quinoa com Legumes", duration: "14 min", emoji: "üåæ" }
            ];
            
            container.innerHTML = videos.map(video => `
                <div class="bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="h-48 bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center">
                        <span class="text-6xl">${video.emoji}</span>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-2">${video.title}</h3>
                        <p class="text-gray-600 text-sm mb-4">Aprenda o passo a passo completo</p>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-500">‚è±Ô∏è ${video.duration}</span>
                            <button onclick="playVideo('${video.title}')" class="text-white px-4 py-2 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #5f723f;">
                                Assistir
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function playVideo(title) {
            showSuccessMessage(`Reproduzindo: ${title}`);
        }

        // User menu functions
        function toggleUserMenu() {
            const menu = document.getElementById('user-menu');
            menu.classList.toggle('hidden');
        }

        function showProfileDetails() {
            document.getElementById('user-menu').classList.add('hidden');
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Detalhes do Perfil</h2>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">Nome:</span>
                            <span class="text-gray-600">${currentUser.name}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">E-mail:</span>
                            <span class="text-gray-600">${currentUser.email}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">Plano:</span>
                            <span class="text-gray-600">${currentUser.plan}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">Idade:</span>
                            <span class="text-gray-600">${currentUser.age} anos</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">Peso:</span>
                            <span class="text-gray-600">${currentUser.weight} kg</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-medium text-gray-700">Altura:</span>
                            <span class="text-gray-600">${currentUser.height} cm</span>
                        </div>
                    </div>
                    
                    <div class="mt-8 text-center">
                        <button onclick="this.closest('.fixed').remove()" class="text-white px-8 py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #5f723f;">
                            Fechar
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showSupport() {
            document.getElementById('user-menu').classList.add('hidden');
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            
            let supportContent;
            if (currentUser.plan === 'Premium') {
                supportContent = `
                    <div class="space-y-4">
                        <p class="text-gray-600">Como usu√°rio Premium, voc√™ tem acesso ao chat ao vivo com nossa IA especializada!</p>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex items-center space-x-3 mb-3">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center" style="background-color: #5f723f;">
                                    <span class="text-white text-sm">ü§ñ</span>
                                </div>
                                <span class="font-medium">Assistente IA</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-3">Ol√°! Como posso ajud√°-lo hoje?</p>
                            <div class="flex space-x-2">
                                <input type="text" placeholder="Digite sua mensagem..." class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                                <button onclick="sendChatMessage()" class="text-white px-4 py-2 rounded-lg text-sm font-semibold" style="background-color: #5f723f;">
                                    Enviar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                supportContent = `
                    <div class="space-y-4">
                        <p class="text-gray-600">Entre em contato conosco por e-mail:</p>
                        <form onsubmit="sendSupportEmail(event)">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Assunto</label>
                                    <input type="text" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Mensagem</label>
                                    <textarea rows="4" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 resize-none"></textarea>
                                </div>
                                <button type="submit" class="w-full text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-colors" style="background-color: #5f723f;">
                                    Enviar E-mail
                                </button>
                            </div>
                        </form>
                    </div>
                `;
            }
            
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Suporte</h2>
                    </div>
                    
                    ${supportContent}
                    
                    <div class="mt-8 text-center">
                        <button onclick="this.closest('.fixed').remove()" class="border-2 border-gray-300 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                            Fechar
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function sendChatMessage() {
            showSuccessMessage('Mensagem enviada! Nossa IA responder√° em breve.');
        }

        function sendSupportEmail(event) {
            event.preventDefault();
            showSuccessMessage('E-mail enviado com sucesso! Responderemos em breve.');
            event.target.closest('.fixed').remove();
        }

        function showSettings() {
            document.getElementById('user-menu').classList.add('hidden');
            
            // Load current user data
            document.getElementById('edit-name').value = currentUser.name;
            document.getElementById('edit-age').value = currentUser.age;
            document.getElementById('edit-gender').value = currentUser.gender;
            document.getElementById('edit-weight').value = currentUser.weight;
            document.getElementById('edit-height').value = currentUser.height;
            
            // Load restrictions
            const restrictions = currentUser.restrictions || [];
            document.querySelectorAll('input[name="edit-restrictions"]').forEach(checkbox => {
                checkbox.checked = restrictions.includes(checkbox.value);
            });
            
            document.getElementById('settings-modal').classList.remove('hidden');
        }

        function closeSettingsModal() {
            document.getElementById('settings-modal').classList.add('hidden');
        }

        function showSettingsTab(tab) {
            // Hide all tabs
            document.getElementById('settings-profile-tab').classList.add('hidden');
            document.getElementById('settings-restrictions-tab').classList.add('hidden');
            
            // Update tab buttons
            document.getElementById('settings-tab-profile').classList.remove('border-green-500');
            document.getElementById('settings-tab-profile').classList.add('border-transparent', 'text-gray-600');
            document.getElementById('settings-tab-restrictions').classList.remove('border-green-500');
            document.getElementById('settings-tab-restrictions').classList.add('border-transparent', 'text-gray-600');
            
            // Show selected tab
            document.getElementById(`settings-${tab}-tab`).classList.remove('hidden');
            document.getElementById(`settings-tab-${tab}`).classList.add('border-green-500');
            document.getElementById(`settings-tab-${tab}`).classList.remove('border-transparent', 'text-gray-600');
            document.getElementById(`settings-tab-${tab}`).style.color = '#5f723f';
        }

        function handleEditProfile(event) {
            event.preventDefault();
            
            currentUser.name = document.getElementById('edit-name').value;
            currentUser.age = parseInt(document.getElementById('edit-age').value);
            currentUser.gender = document.getElementById('edit-gender').value;
            currentUser.weight = parseFloat(document.getElementById('edit-weight').value);
            currentUser.height = parseInt(document.getElementById('edit-height').value);
            
            // Update in storage
            users[currentUser.email] = currentUser;
            localStorage.setItem('vivasabor_users', JSON.stringify(users));
            localStorage.setItem('vivasabor_current_user', JSON.stringify(currentUser));
            
            updateDashboardInfo();
            showSuccessMessage('Perfil atualizado com sucesso!');
            closeSettingsModal();
        }

        function handleEditRestrictions(event) {
            event.preventDefault();
            
            const restrictions = Array.from(document.querySelectorAll('input[name="edit-restrictions"]:checked'))
                .map(checkbox => checkbox.value);
            
            currentUser.restrictions = restrictions;
            
            // Update in storage
            users[currentUser.email] = currentUser;
            localStorage.setItem('vivasabor_users', JSON.stringify(users));
            localStorage.setItem('vivasabor_current_user', JSON.stringify(currentUser));
            
            showSuccessMessage('Restri√ß√µes alimentares atualizadas com sucesso!');
            closeSettingsModal();
        }

        // Formatting functions
        function formatPhone(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
                input.value = value;
            }
        }

        function formatCPF(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                input.value = value;
            }
        }

        function formatCEP(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length <= 8) {
                value = value.replace(/(\d{2})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1-$2');
                input.value = value;
            }
        }

        // Plan selection functions
        function showPlanSelectionModal() {
            // Show initial message first
            showPlanInfoMessage();
        }

        function showPlanInfoMessage() {
            const modal = document.createElement('div');
            modal.id = 'plan-info-modal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-lg w-full mx-4">
                    <div class="text-center mb-10">
                        <div class="w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 gradient-primary">
                            <span class="text-white text-3xl">üîí</span>
                        </div>
                        <h2 class="text-3xl font-bold text-gradient mb-4">Recurso Bloqueado</h2>
                        <p class="text-gray-600 text-lg mb-6">Para acessar este recurso, voc√™ precisa assinar um de nossos planos premium.</p>
                        <p class="text-gray-500">Assine o plano para liberar todos os recursos exclusivos da Viva Sabor!</p>
                    </div>
                    
                    <div class="space-y-4">
                        <button onclick="showPlanOptions()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg shadow-lg">
                            ‚ú® Escolha seu Plano
                        </button>
                        <button onclick="closePlanInfoModal()" class="w-full border-2 border-gray-300 text-gray-700 py-4 rounded-xl font-bold hover:bg-gray-50 transition-colors">
                            Continuar Gratuito
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function closePlanInfoModal() {
            const modal = document.getElementById('plan-info-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }

        function showPlanOptions() {
            closePlanInfoModal();
            document.getElementById('plan-selection-modal').classList.remove('hidden');
        }

        function closePlanSelectionModal() {
            document.getElementById('plan-selection-modal').classList.add('hidden');
        }

        function selectPlan(planName, planPrice) {
            selectedPlan = { name: planName, price: planPrice };
            document.getElementById('selected-plan-name').textContent = `Plano ${planName}`;
            document.getElementById('selected-plan-price').textContent = `R$ ${planPrice.toFixed(2)}`;
            
            closePlanSelectionModal();
            document.getElementById('payment-modal').classList.remove('hidden');
        }

        function closePaymentModal() {
            document.getElementById('payment-modal').classList.add('hidden');
            document.getElementById('payment-form').reset();
            document.getElementById('card-fields').classList.add('hidden');
        }

        function handlePayment(event) {
            event.preventDefault();
            
            const paymentMethod = document.getElementById('payment-method').value;
            
            if (paymentMethod === 'credit' || paymentMethod === 'debit') {
                const cardNumber = document.getElementById('card-number').value;
                const cardExpiry = document.getElementById('card-expiry').value;
                const cardCvv = document.getElementById('card-cvv').value;
                const cardName = document.getElementById('card-name').value;
                
                if (!cardNumber || !cardExpiry || !cardCvv || !cardName) {
                    showErrorMessage('Preencha todos os dados do cart√£o!');
                    return;
                }
            }
            
            // Update user plan
            currentUser.plan = selectedPlan.name;
            users[currentUser.email] = currentUser;
            localStorage.setItem('vivasabor_users', JSON.stringify(users));
            localStorage.setItem('vivasabor_current_user', JSON.stringify(currentUser));
            
            closePaymentModal();
            updateDashboardInfo();
            
            showSuccessMessage(`Parab√©ns! Voc√™ agora √© um usu√°rio ${selectedPlan.name}. Todos os recursos foram desbloqueados!`);
        }

        // Payment method change handler
        document.addEventListener('DOMContentLoaded', function() {
            const paymentMethodSelect = document.getElementById('payment-method');
            if (paymentMethodSelect) {
                paymentMethodSelect.addEventListener('change', function() {
                    const cardFields = document.getElementById('card-fields');
                    if (this.value === 'credit' || this.value === 'debit') {
                        cardFields.classList.remove('hidden');
                        // Make card fields required
                        document.getElementById('card-number').required = true;
                        document.getElementById('card-expiry').required = true;
                        document.getElementById('card-cvv').required = true;
                        document.getElementById('card-name').required = true;
                    } else {
                        cardFields.classList.add('hidden');
                        // Remove required from card fields
                        document.getElementById('card-number').required = false;
                        document.getElementById('card-expiry').required = false;
                        document.getElementById('card-cvv').required = false;
                        document.getElementById('card-name').required = false;
                    }
                });
            }
        });

        // Card formatting functions
        function formatCardNumber(input) {
            let value = input.value.replace(/\D/g, '');
            value = value.replace(/(\d{4})(?=\d)/g, '$1 ');
            input.value = value;
        }

        function formatCardExpiry(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            input.value = value;
        }

        // Utility functions
        function showSuccessMessage(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 3000);
        }

        function showErrorMessage(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 3000);
        }

        // FAQ functions
        function toggleFAQ(faqId) {
            const faqContent = document.getElementById(faqId);
            const faqIcon = document.getElementById(faqId + '-icon');
            
            if (faqContent.classList.contains('hidden')) {
                faqContent.classList.remove('hidden');
                faqIcon.textContent = '-';
            } else {
                faqContent.classList.add('hidden');
                faqIcon.textContent = '+';
            }
        }

        // Contact form handler
        function handleContactForm(event) {
            event.preventDefault();
            showSuccessMessage('Mensagem enviada com sucesso! Responderemos em breve.');
            event.target.reset();
        }

        // Plan carousel functions
        let currentPlanIndex = 0;
        
        function showPlan(index) {
            const carousel = document.getElementById('plans-carousel');
            const dots = document.querySelectorAll('[id^="plan-dot-"]');
            
            currentPlanIndex = index;
            carousel.style.transform = `translateX(-${index * 100}%)`;
            
            // Update dots
            dots.forEach((dot, i) => {
                if (i === index) {
                    dot.classList.remove('bg-gray-300');
                    dot.classList.add('bg-green-500');
                } else {
                    dot.classList.remove('bg-green-500');
                    dot.classList.add('bg-gray-300');
                }
            });
        }
        
        // Touch/swipe support for plan carousel
        let startX = 0;
        let currentX = 0;
        let isDragging = false;
        
        document.addEventListener('DOMContentLoaded', function() {
            const carousel = document.getElementById('plans-carousel');
            if (carousel) {
                carousel.addEventListener('touchstart', handleTouchStart, { passive: true });
                carousel.addEventListener('touchmove', handleTouchMove, { passive: true });
                carousel.addEventListener('touchend', handleTouchEnd, { passive: true });
                
                // Mouse events for desktop
                carousel.addEventListener('mousedown', handleMouseStart);
                carousel.addEventListener('mousemove', handleMouseMove);
                carousel.addEventListener('mouseup', handleMouseEnd);
                carousel.addEventListener('mouseleave', handleMouseEnd);
            }
        });
        
        function handleTouchStart(e) {
            startX = e.touches[0].clientX;
            isDragging = true;
        }
        
        function handleTouchMove(e) {
            if (!isDragging) return;
            currentX = e.touches[0].clientX;
        }
        
        function handleTouchEnd(e) {
            if (!isDragging) return;
            isDragging = false;
            
            const diffX = startX - currentX;
            const threshold = 50;
            
            if (Math.abs(diffX) > threshold) {
                if (diffX > 0 && currentPlanIndex < 1) {
                    showPlan(currentPlanIndex + 1);
                } else if (diffX < 0 && currentPlanIndex > 0) {
                    showPlan(currentPlanIndex - 1);
                }
            }
        }
        
        function handleMouseStart(e) {
            startX = e.clientX;
            isDragging = true;
            e.preventDefault();
        }
        
        function handleMouseMove(e) {
            if (!isDragging) return;
            currentX = e.clientX;
        }
        
        function handleMouseEnd(e) {
            if (!isDragging) return;
            isDragging = false;
            
            const diffX = startX - currentX;
            const threshold = 50;
            
            if (Math.abs(diffX) > threshold) {
                if (diffX > 0 && currentPlanIndex < 1) {
                    showPlan(currentPlanIndex + 1);
                } else if (diffX < 0 && currentPlanIndex > 0) {
                    showPlan(currentPlanIndex - 1);
                }
            }
        }
        
        // Fruit selection toggle function
        function toggleFruitSelection() {
            const fruitSelection = document.getElementById('fruit-selection');
            const sobremesasCheckbox = document.querySelector('input[value="sobremesas"]');
            
            if (sobremesasCheckbox.checked) {
                fruitSelection.classList.remove('hidden');
            } else {
                fruitSelection.classList.add('hidden');
                // Uncheck all fruit preferences when sobremesas is unchecked
                document.querySelectorAll('input[name="avoid-fruits"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
            }
        }

        // Close user menu when clicking outside
        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('user-menu');
            const userButton = event.target.closest('[onclick="toggleUserMenu()"]');
            
            if (userButton || !userMenu) return;
            
            if (!userMenu.contains(event.target)) {
                userMenu.classList.add('hidden');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9732d28e01e2f61f',t:'MTc1NTg3MDQ1MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
